<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Enervi7 â€¢ Journey + Measure + Oracle + Oils (FULL Single File)</title>
<meta name="theme-color" content="#6d28d9">
<style>
  :root{
    --bg:#0f0c18;--panel:#16142a;--card:#14122a;--text:#efeaff;--muted:#b9b6cf;
    --brand:#7a3cff;--brand2:#66e1ff;--ok:#22c55e;--warn:#f59e0b;
  }
  html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.65 -apple-system,BlinkMacSystemFont,"Segoe UI","PingFang TC","Noto Sans TC",Inter,Roboto,"Helvetica Neue",Arial,sans-serif}
  .wrap{max-width:980px;margin:0 auto;padding:18px 16px 64px}
  header{background:linear-gradient(180deg,#6d28d9 0%,#4c1d95 100%);padding:24px 16px 18px}
  h1{margin:0;font-size:28px;font-weight:800}
  .sub{opacity:.9;margin-top:6px}
  .section{background:var(--panel);border:1px solid rgba(255,255,255,.07);border-radius:16px;padding:16px;margin:14px 0;box-shadow:0 6px 28px rgba(0,0,0,.25)}
  h2{margin:0 0 10px;font-size:20px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .btn{background:var(--brand);border:0;color:#fff;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
  .btn.secondary{background:#2a2550}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#272348;color:#dcd7ff;font-size:12px}
  .muted{color:var(--muted)} .sm{font-size:13px;color:var(--muted)}
  input[type=range]{width:100%}
  .q{background:var(--card);border:1px solid #26234a;border-radius:12px;padding:12px;margin:10px 0}
  #radar{width:100%;height:auto;display:block}
  .card{background:var(--card);border:1px solid #26234a;border-radius:12px;padding:12px}
  .kv{background:#24224a;border:1px solid #32305c;border-radius:10px;padding:4px 8px;font-size:12px;margin:2px 4px;display:inline-block}
  details>summary{cursor:pointer;list-style:none}
  details>summary::-webkit-details-marker{display:none}
  .grid2{display:grid;grid-template-columns:1fr;gap:10px}
  @media(min-width:780px){.grid2{grid-template-columns:1fr 1fr}}
  /* æ—…ç¨‹é€²åº¦æ¢ */
  .jbar{height:10px;background:#241f42;border-radius:999px;overflow:hidden}
  .jbar>.fill{height:100%;width:0;background:linear-gradient(90deg,var(--brand),var(--brand2));transition:width .5s ease}
  /* æ‰“å¡æ ¸å– */
  .check{appearance:none;width:22px;height:22px;border-radius:6px;border:2px solid #3a3463;background:transparent;cursor:pointer}
  .check:checked{background:var(--ok);border-color:var(--ok)}
  /* å¾½ç«  / é–é ­ */
  .badge{width:56px;height:56px;border-radius:50%;display:grid;place-items:center;background:#1b1732;position:relative;box-shadow:inset 0 0 0 2px #2d265a}
  .badge svg{width:26px;height:26px;opacity:.9}
  .badge.locked svg path{fill:#8f8cb3}
  .badge.unlocked{animation:pop .5s ease both}
  @keyframes pop{0%{transform:scale(.6)}60%{transform:scale(1.12)}100%{transform:scale(1)}}
  /* è§£é–å…‰æšˆ */
  .badge.unlock::before{
    content:"";position:absolute;inset:-4px;border-radius:inherit;
    background:radial-gradient( circle at 50% 50%, rgba(122,60,255,.55), transparent 60%);
    filter:blur(6px);animation:glow 1.6s ease-in-out 2;
  }
  @keyframes glow{0%,100%{opacity:.2;transform:scale(.95)}50%{opacity:1;transform:scale(1.05)}}
  /* Toast / Modal */
  .toast{position:fixed;left:50%;bottom:26px;transform:translateX(-50%);background:#372a63;color:#fff;border-radius:12px;padding:8px 12px;opacity:.98;z-index:9999}
  dialog{border:0;border-radius:16px;padding:0;background:#181532;color:#efeaff;max-width:560px}
  dialog::backdrop{background:rgba(0,0,0,.55)}
  .dlg-hd{padding:16px 18px;border-bottom:1px solid #2b2650;font-weight:800;display:flex;justify-content:space-between}
  .dlg-bd{padding:16px 18px;white-space:pre-wrap}
  .dlg-ft{padding:14px 18px;border-top:1px solid #2b2650;text-align:right}
  .x{background:#2a2550;border:0;color:#eae6ff;border-radius:10px;padding:8px 12px;font-weight:700;cursor:pointer}
  .footer{opacity:.6;text-align:center;margin-top:14px}
  .search{display:flex;gap:8px;margin-top:8px}
  .search input{flex:1;padding:8px 10px;border-radius:10px;border:1px solid #2f2a56;background:#121029;color:#eae6ff}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>Enervi7 ä¸€é ç‰ˆï¼ˆå®Œæ•´ç‰ˆï¼‰</h1>
    <div class="sub">é‡è¡¨ âœ é›·é” âœ ä¸ƒéšå¡ âœ å‘¢å–ƒç¥è«­ âœ ä»Šæ—¥ç²¾æ²¹ï¼ˆ100+ æ‚ æ¨‚èŠ³è¤‡æ–¹ï¼‰ âœ æ—…ç¨‹æ‰“å¡ï¼ˆé›¢ç·šå¯ç”¨ï¼‰</div>
  </div>
</header>

<main class="wrap">
  <!-- æ—…ç¨‹é€²åº¦ -->
  <section class="section">
    <h2>ğŸŒ€ æ—…ç¨‹é€²åº¦</h2>
    <div class="grid2">
      <!-- 7 æ—¥ -->
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <div class="pill">7 æ—¥èƒ½é‡æŒ‘æˆ°</div>
          <div class="muted"><span id="d7">0</span> / 7 å¤©</div>
        </div>
        <div class="jbar" style="margin:8px 0 10px"><div class="fill" id="p7"></div></div>
        <div class="row" style="justify-content:space-between">
          <label class="row sm"><input id="tick7" class="check" type="checkbox"> å®Œæˆä»Šæ—¥æ‰“å¡</label>
          <div class="badge locked" id="b7" title="æ»¿ 7 å¤©è§£é–">
            <svg viewBox="0 0 24 24" fill="none"><path d="M12 2a5 5 0 00-5 5v3H6a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2v-8a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2a3 3 0 013 3v3H9V7a3 3 0 013-3z" fill="#9a96c7"/></svg>
          </div>
        </div>
      </div>

      <!-- 21 æ—¥ -->
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <div class="pill">21 æ—¥éˆé­‚è½‰åŒ–</div>
          <div class="muted"><span id="d21">0</span> / 21 å¤©</div>
        </div>
        <div class="jbar" style="margin:8px 0 10px"><div class="fill" id="p21"></div></div>
        <div class="row" style="justify-content:space-between">
          <label class="row sm"><input id="tick21" class="check" type="checkbox"> å®Œæˆä»Šæ—¥æ‰“å¡</label>
          <div class="badge locked" id="b21" title="æ»¿ 21 å¤©è§£é–">
            <svg viewBox="0 0 24 24" fill="none"><path d="M12 2a5 5 0 00-5 5v3H6a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2v-8a2 2 0 00-2-2h-1V7a5 5 0 00-5-5z" fill="#9a96c7"/></svg>
          </div>
        </div>
      </div>

      <!-- 30 æ—¥ -->
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <div class="pill">30 æ—¥é¡¯åŒ–æ—¥è¨˜</div>
          <div class="muted"><span id="d30">0</span> / 30 å¤©</div>
        </div>
        <div class="jbar" style="margin:8px 0 10px"><div class="fill" id="p30"></div></div>
        <div class="row" style="justify-content:space-between">
          <label class="row sm"><input id="tick30" class="check" type="checkbox"> å®Œæˆä»Šæ—¥æ‰“å¡</label>
          <div class="badge locked" id="b30" title="æ»¿ 30 å¤©è§£é–">
            <svg viewBox="0 0 24 24" fill="none"><path d="M12 2a5 5 0 00-5 5v3H6a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2v-8a2 2 0 00-2-2h-1V7a5 5 0 00-5-5z" fill="#9a96c7"/></svg>
          </div>
        </div>
      </div>
    </div>
    <div class="sm" style="margin-top:6px">åŒä¸€å¤©åªæœƒè¨ˆ 1 æ¬¡æ‰“å¡ï¼›è·¨æ—¥æ‰æœƒç´¯åŠ ä¸¦å¯å†æ¬¡å‹¾é¸ã€‚</div>
  </section>

  <!-- 14 é¡Œé‡è¡¨ -->
  <section class="section">
    <h2>ğŸ§­ 14 é¡Œé‡è¡¨ï¼ˆ0â€“10ï¼‰</h2>
    <div class="sm">0ï¼å®Œå…¨ä¸ç¬¦åˆï¼å¹¾ä¹æ²’æœ‰ã€€ï½œã€€10ï¼éå¸¸ç¬¦åˆï¼å¹¾ä¹ç¸½æ˜¯</div>
    <div id="qs"></div>
    <div class="row" style="margin-top:8px">
      <button class="btn" id="genRadar">ç”Ÿæˆèƒ½é‡é›·é”åœ–</button>
      <div class="sm">å¹³å‡åˆ†æœƒåæ˜ åˆ°ä¸‹æ–¹ã€Œä¸ƒéšè³‡è¨Šå¡ã€èˆ‡ã€Œä»Šæ—¥ç²¾æ²¹ã€ã€‚</div>
    </div>
  </section>

  <!-- é›·é”åœ– -->
  <section class="section">
    <h2>ğŸ“ˆ èƒ½é‡é›·é”åœ–</h2>
    <svg id="radar" viewBox="0 0 420 420" aria-label="èƒ½é‡é›·é”åœ–"></svg>
    <div id="scoresLine" class="sm" style="margin-top:8px"></div>
  </section>

  <!-- ä¸ƒéšè³‡è¨Šå¡ -->
  <section class="section">
    <h2>ğŸŒˆ ä¸ƒéšè³‡è¨Šå¡ï¼ˆè‡ªå‹•å±•é–‹æœ€ä½å…©éšï¼‰</h2>
    <div id="infoCards"></div>
  </section>

  <!-- å‘¢å–ƒç¥è«­ + ä»Šæ—¥å»ºè­°ç²¾æ²¹ -->
  <section class="section">
    <h2>ğŸª” æ—¥å¸¸å°å¼•</h2>
    <div class="grid2">
      <div class="card">
        <div class="row" style="justify-content:space-between"><b>å‘¢å–ƒç¥è«­ï¼ˆæ¯æ—¥ä¸é‡è¤‡ï¼‰</b><button class="btn secondary" id="rerollOracle">æŠ½ä¸€å¼µ</button></div>
        <div id="oracleBox" class="sm" style="margin-top:8px">ä»Šæ—¥ç¥è«­è¼‰å…¥ä¸­â€¦</div>
      </div>
      <div class="card">
        <div class="row" style="justify-content:space-between"><b>ä»Šæ—¥å»ºè­°ç²¾æ²¹</b>
          <div class="search">
            <input id="oilSearch" placeholder="æœå°‹è‹±æ–‡æˆ–ä¸­æ–‡åç¨±">
            <button class="btn secondary" id="swapOil">æ›ä¸€çµ„</button>
          </div>
        </div>
        <div id="oilBox" class="sm" style="margin-top:8px">è«‹å…ˆå®Œæˆé‡è¡¨ä¸¦ç”Ÿæˆé›·é”åœ–ï¼›ç³»çµ±æœƒä¾æœ€ä½å…©éšæŒ‘é¸ 2â€“3 æ¬¾ã€‚</div>
      </div>
    </div>
  </section>

  <div class="footer sm">Made with ğŸ’œ Enervi7</div>
</main>

<!-- è§£é–å½ˆçª— -->
<dialog id="unlockDlg">
  <div class="dlg-hd">
    <div>ğŸƒ éš±è—éˆé­‚å¡</div>
    <button class="x" onclick="unlockDlg.close()">é—œé–‰</button>
  </div>
  <div class="dlg-bd">
    <div id="cardTitle" style="font-weight:800;font-size:18px;margin-bottom:6px"></div>
    <div id="cardText"></div>
  </div>
  <div class="dlg-ft"><button class="x" onclick="unlockDlg.close()">å¥½çš„</button></div>
</dialog>

<script>
/* =========================
   å¸¸é‡ï¼šéšæ®µã€é¡Œç›®ã€è¡Œå‹•å»ºè­°ã€ç“¶é ¸è½‰æ›
   ========================= */
const STAGES = [
  { key:'ç™½', name:'èƒ½é‡è¦ºçŸ¥' },
  { key:'è—', name:'ç©©å®šèˆ‡æ·¨åŒ–' },
  { key:'æ©™', name:'èƒ½é‡æµå‹•' },
  { key:'é»ƒ', name:'å…§åœ¨åŠ›é‡' },
  { key:'ç¶ ', name:'å…±æŒ¯èˆ‡é€£çµ' },
  { key:'é›è—', name:'æ„è­˜æ“´å±•' },
  { key:'ç´«', name:'éˆé­‚æ•´åˆ' },
];

const QUESTIONS = [
  'æˆ‘èƒ½æ¸…æ¥šè¦ºå¯Ÿè‡ªå·±æ­¤åˆ»çš„èº«å¿ƒç‹€æ…‹ã€‚','æˆ‘èƒ½åœ¨æ··äº‚æ™‚ï¼Œè¿…é€ŸæŠŠæ³¨æ„åŠ›å¸¶å›ç•¶ä¸‹ã€‚',
  'é¢å°å£“åŠ›æˆ–è¡çªæ™‚ï¼Œæˆ‘èƒ½ä¿æŒå†·éœä¸å¤±è¡¡ã€‚','æˆ‘èƒ½æœ‰æ•ˆåœ°é‡‹æ”¾ç´¯ç©çš„è² é¢æƒ…ç·’èˆ‡é›œå¿µã€‚',
  'æˆ‘å¸¸æ„Ÿè¦ºéˆæ„Ÿï¼æƒ…æ„Ÿåœ¨é«”å…§è‡ªç„¶æµå‹•ã€‚','æˆ‘èƒ½é †å‹¢èª¿æ•´æ­¥èª¿ï¼Œä¸åƒµç¡¬æˆ–å¡ä½ã€‚',
  'åšæ±ºå®šæ™‚ï¼Œæˆ‘èƒ½å …å®šåœ°é¸æ“‡å°è‡ªå·±çœŸçš„å¥½çš„äº‹ã€‚','é‡åˆ°æŒ‘æˆ°ï¼Œæˆ‘ä»èƒ½ç›¸ä¿¡è‡ªå·±ä¸¦å¾€å‰ä¸€æ­¥ã€‚',
  'æˆ‘èƒ½çœŸèª è¡¨é”ï¼Œä¹Ÿæ¨‚æ–¼å‚¾è½ä»–äººã€‚','æˆ‘èƒ½æ„Ÿåˆ°è‡ªå·±èˆ‡ä»–äººã€èˆ‡ä¸–ç•Œæ˜¯é€£çµçš„ã€‚',
  'æˆ‘ä¿¡ä»»ç›´è¦ºï¼Œä¸”èƒ½å¾ä¸­ç²å¾—æœ‰ç”¨çš„æŒ‡å¼•ã€‚','æˆ‘èƒ½å¾æ—¥å¸¸äº‹ä»¶çœ‹è¦‹æ›´æ·±çš„æ´è¦‹èˆ‡æ„ç¾©ã€‚',
  'æˆ‘èƒ½æŠŠéå»çš„ç¶“é©—æ•´åˆæˆåŠ›é‡ï¼Œè€Œä¸æ˜¯æ·é–ã€‚','æˆ‘å¸¸æ„Ÿåˆ°è‡ªå·±å®Œæ•´ã€å°ç”Ÿå‘½æ–¹å‘è¸å¯¦å®‰å¿ƒã€‚'
];

const ACTIONS = {
  'ç™½ï½œèƒ½é‡è¦ºçŸ¥':{
    kw:['è¦ºçŸ¥','æ¸…æ˜','é¢å°ç•¶ä¸‹'],
    act:['å¯«ä¸‰å¥ã€Œæ­¤åˆ»æˆ‘çœŸå¯¦çš„æ„Ÿå—æ˜¯â€¦ã€','3 åˆ†é˜è…¹å¼å‘¼å¸ï¼ˆ4-4-6ï¼‰','åˆ—å‡º 1 å€‹åè¦†å¿µé ­ï¼šæ˜¯äº‹å¯¦é‚„æ˜¯è§£è®€ï¼Ÿ']
  },
  'è—ï½œç©©å®šèˆ‡æ·¨åŒ–':{
    kw:['ç©©å®š','é‡‹æ”¾','ç•Œç·š'],
    act:['å¯«ä¸‹å›°æ“¾ä½ çš„ 1 ä»¶äº‹ï¼Œæ¨™è¨»å¯æ§/ä¸å¯æ§','60 ç§’èº«é«”æƒæï¼Œæ”¾é¬†ç·Šç¹ƒéƒ¨ä½','å®Œæˆä¸€ä»¶æ‹–å»¶å°äº‹ä¸¦æ‰“å‹¾']
  },
  'æ©™ï½œèƒ½é‡æµå‹•':{
    kw:['å…è¨±ç™¼ç”Ÿ','å°é½Šæ„åœ–','è³‡æºæ„Ÿ','å®‰å…¨æ„Ÿ'],
    act:['ç”¨ã€Œæˆ‘å…è¨±â€¦ã€é€ å¥ 3 å¥','å›é¡§ 1 æ¬¡è¢«æ”¯æŒçš„è­‰æ“šï¼Œå¯«ä¸‹å¯è¤‡è£½é»','ä»Šå¤©ä¸»å‹•è«‹æ±‚ä¸€æ¬¡å¹«åŠ©ï¼ˆå°ç¯„åœï¼‰']
  },
  'é»ƒï½œå…§åœ¨åŠ›é‡':{
    kw:['æœ€å°æ­¥é©Ÿ','å¯é©—è­‰','ç¯€å¥','åŸ·è¡ŒåŠ›'],
    act:['æŠŠç›®æ¨™æ‹†æˆ 10 åˆ†é˜ä¸€æ­¥ï¼Œç«‹åˆ»åš','è¨­å®šä»Šæ—¥ 3 ä»¶ MIT','å®Œæˆå¾Œå…¬é–‹å›å ±çµ¦å¯ä¿¡ä»»å°è±¡']
  },
  'ç¶ ï½œå…±æŒ¯èˆ‡é€£çµ':{
    kw:['é€£çµ','åƒ¹å€¼æ„Ÿ','è²¢ç»','æ“´æ•£'],
    act:['åˆ†äº«ä¸€å€‹å°æˆæœæˆ–æ´è¦‹åˆ°æœ‹å‹/ç¤¾ç¾¤','é‚€è«‹ 1 äººçµ¦å…·é«”å›é¥‹ï¼ˆ3 å¥ï¼‰','ä¸»å‹•å»ºç«‹ä¸€å€‹åˆä½œå¯èƒ½ï¼ˆç™¼å‡ºé‚€è«‹ï¼‰']
  },
  'é›è—ï½œæ„è­˜æ“´å±•':{
    kw:['å°ˆæ³¨','å›é¥‹å¾ªç’°','éŸŒæ€§','è¿­ä»£'],
    act:['æŠŠå¡é»â†’èª¿æ•´ 1 å€‹å¾®ç­–ç•¥ï¼ˆA/Bï¼‰','25 åˆ†é˜ç•ªèŒ„é˜å…¨ç¨‹å°ˆæ³¨','è¨˜éŒ„ 1 å€‹æœ‰æ•ˆå›é¥‹ï¼Œæ˜å¤©æ²¿ç”¨']
  },
  'ç´«ï½œéˆé­‚æ•´åˆ':{
    kw:['ç¸½çµç¶“é©—','å›ºåŒ–ç¿’æ…£','çµæ§‹åŒ–','é•·æœŸåŒ–'],
    act:['ç”¨ 5 å¥è©±æ‘˜è¦æœ¬é€± 3 ä»¶å­¸åˆ°ï¼‹1 æ”¹é€²','æŠŠæœ‰æ•ˆæ­¥é©Ÿå¯«æˆ Checklist ä¸¦å›ºå®šåˆ°è¡Œç¨‹','ç‚ºä¸‹å€‹é€±æœŸè¨­å®šä¸€å€‹å¯è¡¡é‡æŒ‡æ¨™ï¼ˆKPIï¼‰']
  }
};

const TRANSITION = {
  'S1â†’S2':['æŠŠã€Œæˆ‘è§€å¯Ÿåˆ°â€¦ã€æ”¹å¯«æˆã€Œæˆ‘é¡˜æ„æ”¾ä¸‹â€¦ã€Ã—3','æƒ…ç·’æ›¸å¯«â†’èº«é«”æ”¾é¬†æ”¶å°¾ï¼ˆé ¸è‚©ï¼è…¹éƒ¨ï¼‰'],
  'S2â†’S3':['åˆ—å‡º 3 å€‹ç¾æœ‰è³‡æºï¼ˆäººï¼ç‰©ï¼æŠ€èƒ½ï¼‰','å¯« 1 æ®µï¼šè‹¥ä¸€åˆ‡å°æˆ‘æœ‰åˆ©ï¼Œä»Šå¤©æˆ‘å…è¨±ä»€éº¼ï¼Ÿ'],
  'S3â†’S4':['ç”¢å‡ºã€Œæœ€å°å¯è¡Œæ­¥é©Ÿã€ä¸¦åœ¨ 10 åˆ†é˜å…§å•Ÿå‹•','é ç´„ 1 å€‹ã€Œè¡Œå‹•æ™‚æ®µã€ï¼Œè¡Œå‰åªåšæº–å‚™æ¸…å–®'],
  'S4â†’S5':['æŠŠä»Šæ—¥è¡Œå‹•å›é¥‹è¨˜éŒ„ä¸¦åš 1 æ¬¡å¾®èª¿','å»ºç«‹ 25 åˆ†é˜å°ˆæ³¨å„€å¼ï¼ŒçµæŸå›é¡§ 2 åˆ†é˜'],
  'S5â†’S6':['å…¬é–‹åˆ†äº« 1 å€‹é€²å±•ï¼æ¡ˆä¾‹ï¼Œç´¢å–å…·é«”å›é¥‹','è¾¨è­˜æœ€è¢«å…±é³´çš„åƒ¹å€¼ï¼Œæ˜å¤©ä¸»æ‰“è©²å…ƒç´ '],
  'S6â†’S7':['æŠŠæœ‰æ•ˆåšæ³•å¯«æˆ SOPï¼Checklist','é¸ä¸€å€‹å¯æŒçºŒç¯€å¥ï¼ˆé€±ï¼æœˆï¼‰æ”¾é€²è¡Œäº‹æ›†'],
  'S7â†’S1':['æœ¬é€±å›é¡§ 3 å¥ï¼‹ä¸‹ä¸€è¼ªæ–°æ„åœ– 1 å¥','æŒ‘é¸ 1 å€‹æ¬²ç²¾é€²çš„æŒ‡æ¨™ï¼Œè¨­ç½®è§€æ¸¬æ–¹å¼'],
};

/* =========================
   é¡Œç›®æ¸²æŸ“
   ========================= */
const sliders=[], qsBox=document.getElementById('qs');
for(let i=0;i<14;i++){
  const s=Math.floor(i/2);
  const wrap=document.createElement('div'); wrap.className='q';
  wrap.innerHTML=`
    <div><b>${s+1}. ${STAGES[s].key}ï½œ${STAGES[s].name}</b>ï½œ${QUESTIONS[i]}</div>
    <input type="range" min="0" max="10" step="1" value="5" id="q${i}">
    <div class="sm">ç›®å‰ï¼š<span id="qv${i}">5</span> / 10</div>`;
  qsBox.appendChild(wrap);
  const input=wrap.querySelector('input'), v=wrap.querySelector(`#qv${i}`);
  input.addEventListener('input',()=>v.textContent=input.value);
  sliders.push(input);
}

/* =========================
   è¨ˆç®—å¹³å‡ + é›·é”ï¼ˆç´” SVGï¼‰
   ========================= */
function computeStageAverages(){
  const a=Array(7).fill(0);
  for(let s=0;s<7;s++){
    a[s]=(Number(sliders[s*2].value)+Number(sliders[s*2+1].value))/2;
  }
  return a;
}
const radarSVG=document.getElementById('radar'), scoresLine=document.getElementById('scoresLine');
function drawRadar(values){
  const W=420,H=420,CX=W/2,CY=H/2,R=160,LV=5,N=7,ang=(Math.PI*2)/N;
  radarSVG.innerHTML='';
  for(let l=1;l<=LV;l++){
    const r=R*l/LV,p=[]; for(let i=0;i<N;i++){const a=-Math.PI/2+i*ang;p.push(`${CX+r*Math.cos(a)},${CY+r*Math.sin(a)}`)}
    const pg=document.createElementNS('http://www.w3.org/2000/svg','polygon');
    pg.setAttribute('points',p.join(' ')); pg.setAttribute('fill','none'); pg.setAttribute('stroke','rgba(255,255,255,.08)');
    radarSVG.appendChild(pg);
  }
  for(let i=0;i<N;i++){
    const a=-Math.PI/2+i*ang,x=CX+R*Math.cos(a),y=CY+R*Math.sin(a);
    const ln=document.createElementNS('http://www.w3.org/2000/svg','line');
    ln.setAttribute('x1',CX);ln.setAttribute('y1',CY);ln.setAttribute('x2',x);ln.setAttribute('y2',y);ln.setAttribute('stroke','rgba(255,255,255,.08)');
    radarSVG.appendChild(ln);
    const t=document.createElementNS('http://www.w3.org/2000/svg','text');
    t.setAttribute('x',CX+(R+18)*Math.cos(a)); t.setAttribute('y',CY+(R+18)*Math.sin(a));
    t.setAttribute('dominant-baseline','middle');
    t.setAttribute('text-anchor',Math.cos(a)>0.3?'start':(Math.cos(a)<-0.3?'end':'middle'));
    t.setAttribute('fill','#c8b6ff'); t.setAttribute('font-size','12');
    t.textContent=`${STAGES[i].key}ï½œ${STAGES[i].name}`; radarSVG.appendChild(t);
  }
  const pts=[]; for(let i=0;i<N;i++){const r=(values[i]/10),a=-Math.PI/2+i*ang;pts.push(`${CX+R*r*Math.cos(a)},${CY+R*r*Math.sin(a)}`)}
  const area=document.createElementNS('http://www.w3.org/2000/svg','polygon');
  area.setAttribute('points',pts.join(' ')); area.setAttribute('fill','rgba(167,139,250,.25)'); area.setAttribute('stroke','rgba(167,139,250,.95)'); area.setAttribute('stroke-width','2');
  radarSVG.appendChild(area);
  scoresLine.textContent = STAGES.map((s,i)=>`${s.key}ï½œ${s.name}ï¼š${values[i].toFixed(1)}`).join(' ï½œ ');
}

/* =========================
   ä¸ƒéšè³‡è¨Šå¡ï¼ˆæœ€ä½å…©éšå±•é–‹ + å…©æ¢è‡¨ç•Œå»ºè­°å‹•æ…‹ï¼‰
   ========================= */
function renderInfoCards(values){
  const list=values.map((v,i)=>({i,v})).sort((a,b)=>a.v-b.v);
  const low2=[list[0].i,list[1].i];
  const box=document.getElementById('infoCards'); box.innerHTML='';
  low2.forEach(idx=>{
    const title=`${STAGES[idx].key}ï½œ${STAGES[idx].name}`;
    const kvs=(ACTIONS[title]?.kw||[]).map(k=>`<span class="kv">${k}</span>`).join('');
    const acts=(ACTIONS[title]?.act||[]).map(x=>'â€¢ '+x).join('<br>');
    const el=document.createElement('details'); el.open=true; el.className='card';
    el.innerHTML = `
      <summary><b>${title}</b> ï½œ å¹³å‡ <b>${values[idx].toFixed(1)}</b> åˆ† <span class="pill">å»ºè­°</span></summary>
      <div style="margin-top:8px">
        <div class="sm">é—œéµå­—ï¼š</div>
        <div style="margin:6px 0">${kvs||'â€”'}</div>
        <div class="sm">è¡Œå‹•å»ºè­°ï¼š</div>
        <div style="margin-top:6px">${acts||'â€”'}</div>
      </div>`;
    box.appendChild(el);
  });
  // å‹•æ…‹è‡¨ç•Œï¼ˆä¾å…©å€‹ä½åˆ†éšæ®µï¼Œé¡¯ç¤ºå°æ‡‰ Sxâ†’Sx+1ï¼‰
  function keyFor(sIdx){ const from=sIdx+1; const to = ((sIdx+1)%7)+1; return `S${from}â†’S${to}`; }
  const k1 = keyFor(low2[0]), k2 = keyFor(low2[1]);
  const tBox=document.createElement('div'); tBox.className='card'; tBox.style.marginTop='10px';
  const renderLine=(k)=>`<b>${k}</b>ï¼š${(TRANSITION[k]||[]).map(x=>'â€¢ '+x).join('ã€€')||'â€”'}`;
  tBox.innerHTML = `<div class="sm">ç“¶é ¸è½‰æ›æç¤ºï¼ˆä¾å…©å€‹æœ€ä½éšæ®µï¼‰ï¼š</div><div style="margin-top:6px">${renderLine(k1)}<br>${renderLine(k2)}</div>`;
  box.appendChild(tBox);
}

/* =========================
   ç¥è«­ï¼ˆæ¯æ—¥ä¸é‡è¤‡ï¼‰â€” å®Œæ•´ 60 å¼µï¼ˆå¯è‡ªè¡Œå¢æ¸›ï¼‰
   ========================= */
const ORACLE = [
  {title:'å…‰çš„ä¾†æº', text:'ä½ ä¸æ˜¯ç‚ºäº†è¢«é»äº®ï¼Œè€Œæ˜¯å–šé†’æ²‰ç¡çš„éˆé­‚ã€‚', action:'æŠŠæ³¨æ„åŠ›æ”¾åœ¨ã€Œæˆ‘å·²ç¶“åœ¨ç™¼å…‰ã€çš„ä¸€ä»¶å°äº‹ä¸Šã€‚'},
  {title:'ç„¡åä¹‹å…‰', text:'åœ¨ä½ é‚„éœ€è¦åå­—ä¹‹å‰ï¼Œä½ å·²ç¶“æ˜¯å…‰ã€‚', action:'éœé»˜ 60 ç§’ï¼Œè®“è‡ªå·±è¢«çœ‹è¦‹ã€‚'},
  {title:'æˆç‚º', text:'ä½ æ²’æœ‰è®Šå¾—æ›´å¥½ï¼Œåªæ˜¯æ›´çœŸã€‚', action:'å…è¨±è‡ªå·±å‡ºç¾ 1 åˆ†é˜ã€‚'},
  {title:'æ­¸ä¾†', text:'ä½ èµ°éè¬é‡Œï¼ŒåŸä¾†ä½ ä¸€ç›´éƒ½åœ¨é€™è£¡ã€‚', action:'è¼•è²å°è‡ªå·±èªªï¼šæˆ‘å›ä¾†äº†ã€‚'},
  {title:'è‡ªç”±', text:'è‡ªç”±ä¸æ˜¯é€ƒé›¢ï¼Œè€Œæ˜¯ä¸å†å£“æŠ‘çœŸå¯¦çš„è‡ªå·±ã€‚', action:'æ‹’çµ•ä¸€å€‹ä¸åˆæ„çš„å°è«‹æ±‚ã€‚'},
  {title:'éœé»˜', text:'éœé»˜ä¸æ˜¯ç©ºç™½ï¼Œæ˜¯èªè¨€ä¹‹å‰çš„å®Œæ•´ã€‚', action:'åš 3 æ¬¡ 4-4-6 å‘¼å¸ã€‚'},
  {title:'è¨˜å¾—', text:'ä½ ä¸æ˜¯åœ¨å°‹æ‰¾ï¼Œè€Œæ˜¯åœ¨è¨˜å¾—ã€‚', action:'å¯«ä¸€å¥ï¼šæˆ‘æƒ³èµ·äº†â€¦'},
  {title:'çœŸç†', text:'çœŸç†ä¸æ˜¯ä½ ç†è§£çš„ï¼Œè€Œæ˜¯ä½ æ”¾ä¸‹å¾Œé‚„åœ¨çš„ã€‚', action:'å¯«ä¸‹ä»Šå¤©é¡˜æ„æ”¾ä¸‹çš„ 1 ä»¶äº‹ã€‚'},
  {title:'æ„›', text:'æˆ‘çš„å¿ƒä¸æ˜¯å€‰åº«ï¼Œè€Œæ˜¯å¤ªé™½ã€‚', action:'å°ä¸€å€‹äººçµ¦å‡º 1 å¥çœŸèª è‚¯å®šã€‚'},
  {title:'è‡£æœ', text:'åœæ­¢èˆ‡æµå°æŠ—ï¼ŒåŠ›é‡æ‰é–‹å§‹åˆä½œã€‚', action:'ä»Šå¤©æ”¾ä¸‹ã€Œè¦æ§åˆ¶ã€çš„ä¸€å°è™•ã€‚'},
  {title:'å¬å–š', text:'ä½ ä¸æ˜¯å­¸ç¿’æˆç‚ºå…‰ï¼Œè€Œæ˜¯å›æ‡‰å¬å–šã€‚', action:'å¯«ä¸‹ä»Šå¤©çš„ 1 å¥æ„åœ–å®£è¨€ã€‚'},
  {title:'è¦ºå¯Ÿ', text:'çœ‹è¦‹æ­£åœ¨ç™¼ç”Ÿçš„ï¼Œä¸æ€¥è‘—è©•åƒ¹ã€‚', action:'å¯«ä¸‰å¥ã€Œæ­¤åˆ»æˆ‘çœŸå¯¦çš„æ„Ÿå—æ˜¯â€¦ã€ã€‚'},
  {title:'é‡‹æ”¾', text:'é¬†é–‹æ‰‹ï¼Œè®“èƒ½é‡å›åˆ°æµå‹•ã€‚', action:'åš 2 æ®µé‡‹æ”¾æ›¸å¯«ï¼šå¯«å®Œå°±æ’•ï¼ä¸Ÿã€‚'},
  {title:'ä¿¡ä»»', text:'å…è¨±è¢«æ”¯æŒï¼Œå…è¨±æ›´å¤§çš„å–„å±•é–‹ã€‚', action:'ç”¨ã€Œæˆ‘å…è¨±â€¦ã€é€ å¥ 3 å¥ã€‚'},
  {title:'è¡Œå‹•', text:'æœ€å°å¯è¡Œçš„ä¸€æ­¥ï¼Œç«‹åˆ»é€²å ´ã€‚', action:'æŠŠä¸€ä»¶äº‹æ‹†æˆ 10 åˆ†é˜ç‰ˆæœ¬ä¸¦å®Œæˆã€‚'},
  {title:'æµå‹•', text:'å°ˆæ³¨â€”å›é¥‹â€”å¾®èª¿â€”å†å°ˆæ³¨ã€‚', action:'25 åˆ†é˜ç•ªèŒ„é˜ + 2 åˆ†é˜å›é¡§ã€‚'},
  {title:'å…±é³´', text:'æŠŠåƒ¹å€¼é€å‡ºå»ï¼Œå›è²æœƒå‘Šè¨´ä½ è·¯ã€‚', action:'åˆ†äº« 1 å€‹å°é€²å±•ä¸¦è«‹ 1 äººçµ¦å›é¥‹ã€‚'},
  {title:'æ•´åˆ', text:'æŠŠæœ‰æ•ˆå›ºåŒ–æˆçµæ§‹ï¼Œè®“ç¯€å¥å»¶çºŒã€‚', action:'æŠŠä»Šå¤©æœ‰æ•ˆæ­¥é©Ÿå¯«æˆ 3 é» Checklistã€‚'},
  {title:'å…è¨±ä¼‘æ¯', text:'ä¼‘æ¯ä¸æ˜¯é€€å¾Œï¼Œæ˜¯èƒ½é‡å›å……ã€‚', action:'é–‰çœ¼æ”¾é¬†è‚©é ¸ 60 ç§’ã€‚'},
  {title:'é‚Šç•Œ', text:'ç•Œç·šæ˜¯å°è‡ªå·±èˆ‡ä»–äººçš„æ¸…æ™°ã€‚', action:'å°ä¸€ä»¶å°äº‹èªªï¼šä»Šå¤©å…ˆåˆ°é€™è£¡ã€‚'},
  {title:'å°ˆæ³¨', text:'ä½ å°ˆæ³¨çš„åœ°æ–¹ï¼Œå°±æ˜¯èƒ½é‡ç”Ÿé•·çš„åœ°æ–¹ã€‚', action:'æŠŠæ‰‹æ©ŸéœéŸ³ 20 åˆ†é˜ã€‚'},
  {title:'å‹‡æ°£', text:'å¸¶è‘—æ€•ä¹Ÿå‰è¡Œï¼Œå°±æ˜¯å‹‡æ°£ã€‚', action:'åš 1 æ­¥æ›¾çŒ¶è±«çš„è¡Œå‹•ã€‚'},
  {title:'æ„Ÿæ©', text:'æ„Ÿæ©è®“è±ç››çœ‹å¾—è¦‹ã€‚', action:'å¯«ä¸‹ä»Šå¤© 3 ä»¶å€¼å¾—æ„Ÿè¬çš„å°äº‹ã€‚'},
  {title:'æ¾„æ˜', text:'æ¸…æ™°ä¾†è‡ªçœ‹è¦‹ï¼Œä¹Ÿä¾†è‡ªæ”¾ä¸‹é›œè¨Šã€‚', action:'ä»Šå¤©å°‘çœ‹ä¸€æ¬¡ç¤¾ç¾¤ï¼Œé‚„æ™‚é–“çµ¦è‡ªå·±ã€‚'},
  {title:'å°é½Š', text:'ç•¶æ„åœ–å°é½Šï¼Œè·¯å¾‘æœƒè‡ªå·±é¡¯ç¾ã€‚', action:'æŠŠæ„åœ–å°æ‡‰ä¸€å€‹å…·é«”è¡Œå‹•ã€‚'},
  {title:'å–œæ‚…', text:'å¿«æ¨‚ä¸æ˜¯æˆæœï¼Œæ˜¯æ–¹æ³•ã€‚', action:'åš 1 ä»¶è®“ä½ æ˜é¡¯å¾®ç¬‘çš„å°äº‹ã€‚'},
  {title:'æº«æŸ”', text:'æº«æŸ”æ˜¯å·¨å¤§çš„åŠ›é‡ã€‚', action:'è·Ÿè‡ªå·±èªªä¸€å¥æº«æŸ”çš„è©±ã€‚'},
  {title:'æ¸…ç†', text:'æ¸…ç†å°±æ˜¯ç‚ºæ–°ç”Ÿè®“ä½ã€‚', action:'ä¸Ÿæ‰ 1 æ¨£ä¸å†éœ€è¦çš„æ±è¥¿ã€‚'},
  {title:'ä¿¡å¿µ', text:'ä½ ç›¸ä¿¡ä»€éº¼ï¼Œä»€éº¼å°±æœ‰æ©Ÿæœƒé•·å¤§ã€‚', action:'å¯«ä¸‹ 1 å¥æƒ³è¦é¤Šå¤§çš„æ–°ä¿¡å¿µã€‚'},
  {title:'å›å®¶', text:'æœ€å¤§çš„è·¯æ˜¯å›åˆ°è‡ªå·±ã€‚', action:'æŠŠæ‰‹æ”¾åœ¨å¿ƒå£ï¼Œå®‰éœ 30 ç§’ã€‚'},
  {title:'æ­¥ä¼', text:'å¿«æ˜¯æ–¹æ³•ï¼Œæ…¢æ˜¯åŠ›é‡ã€‚', action:'ç”¨æ…¢é€Ÿå®Œæˆä¸€ä»¶å°äº‹ã€‚'},
  {title:'æ›ä½', text:'ç«™åˆ°æ„›çš„ä½ç½®ï¼Œå°±çœ‹è¦‹è·¯ã€‚', action:'æŠŠä»Šå¤©çš„ä¸€ä»¶äº‹æ›å€‹è§’åº¦çœ‹ã€‚'},
  {title:'ç¨®å­', text:'ä»Šå¤©çš„ä¸€é»é»ï¼Œå°±æ˜¯æ˜å¤©çš„ä¸€æ•´ç‰‡ã€‚', action:'ç¨®ä¸‹ä¸€å€‹ 2 åˆ†é˜çš„å°ç¿’æ…£ã€‚'},
  {title:'å›æœ›', text:'å›æœ›ä¸æ˜¯å¾Œé€€ï¼Œæ˜¯å¸¶è‘—ç†è§£å‰è¡Œã€‚', action:'å¯«ä¸‹ 1 æ¬¡è¢«æ”¯æŒçš„è­‰æ“šã€‚'},
  {title:'å®¹ç´', text:'æŠŠæƒ…ç·’æ”¾åœ¨æ‡·è£¡ï¼Œè€Œä¸æ˜¯åˆ¤æ±ºæ›¸ä¸Šã€‚', action:'ç‚ºä¸€å€‹æ„Ÿå—èµ·åå­—ã€‚'},
  {title:'ä¸€è‡´', text:'å¿ƒã€å£ã€æ‰‹åŒä¸€æ–¹å‘ï¼Œå°±æœƒæœ‰é¢¨ã€‚', action:'ä»Šå¤©è®“ä¸€å¥è©±å°é½Šä¸€å€‹å‹•ä½œã€‚'},
  {title:'æœŸå¾…', text:'ä½ ä»¥ç‚ºçš„ç¼ºå£ï¼Œæ­£åœ¨é€å…‰ã€‚', action:'ç‚ºå›°é›£å¯«ä¸€æ®µç¥ç¦ã€‚'},
  {title:'é‚æ­¥', text:'æŠ¬é ­çš„é‚£åˆ»ï¼Œè·¯å°±ä¸å†ç‹¹çª„ã€‚', action:'èµ°è·¯ 10 åˆ†é˜ï¼Œåªçœ‹å¤©ç©ºã€‚'},
  {title:'ç¶»æ”¾', text:'ä¸å¿…å®Œç¾ï¼Œç¶»æ”¾å°±æ˜¯ç­”æ¡ˆã€‚', action:'åš 2 åˆ†é˜çš„å°å‰µä½œï¼šå¡—é´‰/å­—å¥ã€‚'},
  {title:'é‚€è«‹', text:'ä½ åœ¨è·¯ä¸Šï¼Œè·¯ä¹Ÿåœ¨æ‰¾ä½ ã€‚', action:'ç™¼å‡ºä¸€å‰‡åˆä½œ/å•å€™è¨Šæ¯ã€‚'},
  {title:'å®ˆå€™', text:'è€å¿ƒæ˜¯æº«æŸ”çš„åŠ›é‡ã€‚', action:'ç‚ºé‡è¦ç›®æ¨™é ç´„å°ˆæ³¨æ™‚æ®µã€‚'},
  {title:'æ‰“é–‹çª—', text:'æŠŠçª—æ‰“é–‹ï¼Œé¢¨å°±æ‡‚å¾—é€²ä¾†ã€‚', action:'é€šé¢¨æˆ–é»ç²¾æ²¹ 3 åˆ†é˜ã€‚'},
  {title:'éˆæ„Ÿ', text:'ç­”æ¡ˆé•·åœ¨å®‰éœè£¡ã€‚', action:'å®‰éœ 3 åˆ†é˜ï¼Œè¨˜ä¸‹ç¬¬ä¸€å€‹å¿µé ­ã€‚'},
  {title:'å‡è¦–', text:'ä½ è¶Šçœ‹è¦‹ï¼Œæœ¬è³ªè¶Šæ¸…æ™°ã€‚', action:'ç›¯ä½ä¸€å€‹ç›®æ¨™ 120 ç§’ï¼Œåªå‘¼å¸ã€‚'},
  {title:'è¼•ç›ˆ', text:'æŠŠé‡æ“”æš«æ”¾åœ°ä¸Šï¼Œè©¦è©¦èµ°å…©æ­¥ã€‚', action:'æš«åœä¸€ä»¶æœƒè€—èƒ½çš„äº‹ã€‚'},
  {title:'ä¿¡æ‰‹', text:'ä¸å¿…å‰å¤§ï¼Œå…ˆè®“æ‰‹å‹•èµ·ä¾†ã€‚', action:'æ‰‹å¯«ä¸€è¡Œå­—ï¼Œé–‹å§‹å°±å¥½ã€‚'},
  {title:'åˆä¸€', text:'ç•¶ä½ å›åˆ°æ•´é«”ï¼ŒåŒ±ä¹å°±æ¶ˆå¤±ã€‚', action:'èˆ‡ä¸€å€‹äººé€£çµ 3 å¥çœŸèª å°è©±ã€‚'},
  {title:'ç¯¤å®š', text:'ç­”æ¡ˆä¸åœ¨é æ–¹ï¼Œåœ¨ä½ è…³ä¸‹çš„æ¯ä¸€æ­¥ã€‚', action:'ä»Šå¤©å®Œæˆ 1 ä»¶æœ€å°å¯è¡Œæ­¥é©Ÿã€‚'},
  {title:'å…‰åˆä½œç”¨', text:'æŠŠè®šç¾æ”¶ä¸‹ï¼Œä¹ŸæŠŠæ„›æ•£å‡ºå»ã€‚', action:'çœŸèª ç¨±è®š 1 äººã€‚'},
  {title:'é»ç‡ˆ', text:'é»‘æš—ä¸æ˜¯æ•µäººï¼Œæ˜¯ä½ ç·´ç¿’ç™¼å…‰çš„å ´ã€‚', action:'ç‚ºä¸€å€‹ä¸é †å¿ƒè™•é»ä¸€ç›å°ç‡ˆï¼ˆæˆ–è Ÿç‡­ï¼‰ã€‚'},
  {title:'æ¥ç´', text:'å…ˆæ¥ç´ï¼Œæ‰æœ‰æ”¹è®Šã€‚', action:'èªªä¸€å¥ï¼šæˆ‘å…è¨±è‡ªå·±å…ˆæ˜¯ç¾åœ¨é€™æ¨£ã€‚'},
  {title:'åˆå¿ƒ', text:'ä½ ç‚ºä½•å‡ºç™¼ï¼Ÿå›åˆ°é‚£å€‹å–®ç´”ç†ç”±ã€‚', action:'å¯«ä¸‹ä½ çš„ 1 å¥åˆå¿ƒå®£è¨€ã€‚'},
  {title:'çœ‹è¦‹è¶³å¤ ', text:'ä½ å·²ç¶“æ“æœ‰å®Œæˆä»Šå¤©çš„ã€Œè¶³å¤ ã€ã€‚', action:'åˆ— 3 å€‹ç¾æœ‰è³‡æºï¼ˆäºº/ç‰©/æŠ€èƒ½ï¼‰ã€‚'},
  {title:'æµ·å¹³é¢', text:'æµªä¾†æµªå»ï¼Œæµ·å§‹çµ‚åœ¨ã€‚', action:'åš 6 æ¬¡æ·±å‘¼å¸ï¼Œæ„Ÿå—èƒ¸å£æ²‰ç©©ã€‚'}
];
function dayKey(prefix){ return `${prefix}_${new Date().toISOString().slice(0,10)}`; }
function drawOracle(force=false){
  const k = dayKey('e7_oracle_full');
  if(!force){
    const cached = localStorage.getItem(k);
    if(cached){ document.getElementById('oracleBox').innerHTML = cached; return; }
  }
  const pick = ORACLE[Math.floor(Math.random()*ORACLE.length)];
  const html = `<div class="sm">ã€Œ${pick.title}ã€</div><div style="margin-top:6px">${pick.text}</div><div class="sm" style="margin-top:8px"><b>è¡Œå‹•ï¼š</b>${pick.action}</div>`;
  document.getElementById('oracleBox').innerHTML = html;
  localStorage.setItem(k, html);
}
document.getElementById('rerollOracle').addEventListener('click',()=>drawOracle(true));

/* =========================
   æ‚ æ¨‚èŠ³è¤‡æ–¹ç²¾æ²¹ â€” 100+ å…§å»ºï¼ˆç¿»è­¯ä»¥å°ç£å¸¸ç”¨è­¯åç‚ºåŸºæº–ï¼Œå¯å†å¾®èª¿ï¼‰
   ========================= */
const YL = [
  {"name":"Abundance","zh_name":"è±ç››","description":"æå‡é¡¯åŒ–èƒ½é‡ï¼Œå¸å¼•ç¹ç››èˆ‡è±è£•ã€‚"},
  {"name":"Acceptance","zh_name":"æ¥å—","description":"æ“æŠ±ç•¶ä¸‹ï¼Œèˆ‡ç¾å¯¦å’Œå¹³ç›¸è™•ã€‚"},
  {"name":"AromaEase","zh_name":"èˆ’ç·©","description":"æ”¾é¬†å£“åŠ›ã€æ”¯æŒå®‰å®šå‘¼å¸ã€‚"},
  {"name":"Aroma Life","zh_name":"ç”Ÿå‘½æ´»åŠ›","description":"å–šé†’å…§åœ¨æ´»åŠ›ï¼Œæ”¯æŒå¾ªç’°ã€‚"},
  {"name":"Aroma Siez","zh_name":"èˆ’æ´»","description":"é‡‹æ”¾ç·Šç¹ƒèˆ‡å£“åŠ›ï¼Œèº«å¿ƒèˆ’å±•ã€‚"},
  {"name":"Australian Kuranya","zh_name":"æ¾³æ´²å½©è™¹","description":"èåˆæ¾³æ´²æ¤ç‰©èƒ½é‡ï¼Œæ·¨åŒ–èˆ‡æ›´æ–°ã€‚"},
  {"name":"Awaken","zh_name":"è¦ºé†’","description":"å–šé†’éˆé­‚ä½¿å‘½èˆ‡æ½›èƒ½ã€‚"},
  {"name":"Believe","zh_name":"ä¿¡å¿µ","description":"å¼·åŒ–ä¿¡å¿ƒèˆ‡é¡˜æ™¯ã€‚"},
  {"name":"Brain Power","zh_name":"è…¦æ´»åŠ›","description":"æå‡å°ˆæ³¨èˆ‡æ¸…æ™°æ€è€ƒã€‚"},
  {"name":"Build Your Dream","zh_name":"ç¯‰å¤¢","description":"æ”¯æŒå¤¢æƒ³é¡¯åŒ–ï¼Œå¯¦ç¾è—åœ–ã€‚"},
  {"name":"Citrus Fresh","zh_name":"å„ªæ©˜","description":"æ¸…æ–°æŸ‘æ©˜èª¿ï¼Œå¸¶ä¾†æ„‰æ‚…ã€‚"},
  {"name":"Christmas Spirit","zh_name":"è–èª•ç²¾ç¥","description":"æº«æš–å–œæ‚…çš„ç¯€æ…¶æ°£æ¯ã€‚"},
  {"name":"Clarity","zh_name":"æ¾„æ™°","description":"æ¸…æ™°å¿ƒæ™ºèˆ‡æ–¹å‘ã€‚"},
  {"name":"Cool Azul","zh_name":"é…·è—","description":"æ¸…æ¶¼èˆ’ç·©ï¼Œé‹å‹•å¾Œæ”¾é¬†ã€‚"},
  {"name":"Deep Relief","zh_name":"æ·±å±¤èˆ’ç·©","description":"èˆ’ç·©å£“åŠ›èˆ‡ç·Šç¹ƒã€‚"},
  {"name":"DiGize","zh_name":"æ¨‚èƒƒèˆ’","description":"ç©©å®šæ¶ˆåŒ–æ„Ÿå—èˆ‡èˆ’é©ã€‚"},
  {"name":"Dragon Time","zh_name":"é¾ä¹‹æ™‚å…‰","description":"å¥³æ€§é€±æœŸæ”¯æŒèˆ‡æƒ…ç·’èª¿å’Œã€‚"},
  {"name":"Dream Catcher","zh_name":"æ•å¤¢ç¶²","description":"æ“´å±•æƒ³åƒèˆ‡ç›´è¦ºã€‚"},
  {"name":"EndoFlex","zh_name":"æŸ”è¡¡","description":"æ”¯æŒèƒ½é‡æµå‹•èˆ‡å¹³è¡¡ã€‚"},
  {"name":"En-R-Gee","zh_name":"è¦ºé†’èƒ½é‡","description":"å–šé†’ç²¾ç¥èˆ‡æ´»åŠ›ã€‚"},
  {"name":"Envision","zh_name":"é¡˜æ™¯","description":"æ¸…æ™°å…§åœ¨è—åœ–èˆ‡ç›®æ¨™ã€‚"},
  {"name":"Egyptian Gold","zh_name":"åŸƒåŠé»ƒé‡‘","description":"é€£çµå¤è€æ™ºæ…§èˆ‡ç¥è–å®ˆè­·ã€‚"},
  {"name":"Exodus II","zh_name":"å‡ºåŸƒåŠè¨˜ II","description":"éˆæ€§ä¿è­·èˆ‡ä¿¡å¿µæ”¯æŒã€‚"},
  {"name":"Forgiveness","zh_name":"å¯¬æ•","description":"é‡‹æ”¾éå»ï¼Œå¸¶ä¾†è‡ªç”±ã€‚"},
  {"name":"Gathering","zh_name":"èšåˆ","description":"å°ˆæ³¨ä½¿å‘½ï¼Œéˆæ€§é€£çµã€‚"},
  {"name":"Gentle Baby","zh_name":"æº«æŸ”å¯¶è²","description":"æº«æŸ”æ»‹é¤Šï¼Œé©åˆè¦ªå­æ™‚å…‰ã€‚"},
  {"name":"Gratitude","zh_name":"æ„Ÿæ©","description":"å–šé†’æ„Ÿæ©å¿ƒèˆ‡æ­£å‘èƒ½é‡ã€‚"},
  {"name":"Grounding","zh_name":"ç©©å®š","description":"ç´®æ ¹æ–¼ç•¶ä¸‹ï¼Œå®‰å®šè¸å¯¦ã€‚"},
  {"name":"Harmony","zh_name":"å’Œè«§ï¼ˆæ¨‚èï¼‰","description":"å¹³è¡¡èº«å¿ƒèƒ½é‡èˆ‡é—œä¿‚ã€‚"},
  {"name":"Highest Potential","zh_name":"è‡³é«˜æ½›èƒ½","description":"å–šé†’æœ€é«˜å¯èƒ½æ€§ã€‚"},
  {"name":"Hope","zh_name":"å¸Œæœ›","description":"æ³¨å…¥å¸Œæœ›èˆ‡å…‰æ˜ã€‚"},
  {"name":"Humility","zh_name":"è¬™å‘","description":"æŸ”åŒ–è‡ªæˆ‘ï¼Œé€£çµæ›´é«˜æ™ºæ…§ã€‚"},
  {"name":"ImmuPower","zh_name":"é˜²è­·èƒ½é‡","description":"æå‡å ´åŸŸå®ˆè­·æ„Ÿã€‚"},
  {"name":"Inner Child","zh_name":"å…§åœ¨å°å­©","description":"å–šé†’ç´”çœŸèˆ‡è‡ªæˆ‘æ¥ç´ã€‚"},
  {"name":"Inspiration","zh_name":"éˆæ„Ÿ","description":"æ”¯æŒç›´è¦ºèˆ‡å‰µé€ åŠ›ã€‚"},
  {"name":"Into the Future","zh_name":"æœªä¾†å±•æœ›","description":"æ”¾ä¸‹éå»ï¼Œé‚å‘æ–°ç« ã€‚"},
  {"name":"Joy","zh_name":"å–œæ‚…","description":"å–šé†’å–œæ‚…èˆ‡æ„›çš„é »ç‡ã€‚"},
  {"name":"JuvaCleanse","zh_name":"è‚æ·¨","description":"æ”¯æŒæ›´æ–°èˆ‡æ½”æ·¨æ„Ÿã€‚"},
  {"name":"JuvaFlex","zh_name":"æŸ”è‚","description":"å”åŒå¹³è¡¡ã€èˆ’ç·©æ„Ÿå—ã€‚"},
  {"name":"Longevity","zh_name":"é•·é’","description":"ç©©å›ºæ´»åŠ›èˆ‡éŸŒæ€§ã€‚"},
  {"name":"Live with Passion","zh_name":"ç†±æƒ…ç”Ÿæ´»","description":"æ¿€ç™¼ç†±æƒ…èˆ‡ç”Ÿå‘½åŠ›ã€‚"},
  {"name":"Magnify Your Purpose","zh_name":"æ”¾å¤§ç›®æ¨™","description":"èšç„¦ä½¿å‘½ï¼Œæ”¾å¤§å¯¦ç¾åŠ›ã€‚"},
  {"name":"Melrose","zh_name":"é§å®¹","description":"æ›´æ–°èƒ½é‡ï¼Œå¸¶ä¾†æ¸…æ–°ã€‚"},
  {"name":"M-Grain","zh_name":"é ­é ¸èˆ’ç·©","description":"èˆ’ç·©ç·Šç¹ƒèˆ‡å£“åŠ›ã€‚"},
  {"name":"Mister","zh_name":"ç´³å£«","description":"ç”·æ€§å¹³è¡¡èˆ‡æ”¯æŒã€‚"},
  {"name":"Motivation","zh_name":"å‹•åŠ›","description":"å–šé†’è¡Œå‹•åŠ›èˆ‡ä¿¡å¿ƒã€‚"},
  {"name":"Oola Balance","zh_name":"Oola å¹³è¡¡","description":"ç”Ÿæ´»ä¸ƒåŸŸå¹³è¡¡ï¼ˆOola ç³»åˆ—ï¼‰ã€‚"},
  {"name":"Oola Finance","zh_name":"Oola è²¡å¯Œ","description":"é‡‘éŒ¢è§€èˆ‡åƒ¹å€¼å°é½Šã€‚"},
  {"name":"Oola Fitness","zh_name":"Oola å¥é«”","description":"æ´»åŠ›èˆ‡ç´€å¾‹ã€‚"},
  {"name":"Oola Family","zh_name":"Oola å®¶åº­","description":"é€£çµèˆ‡æ”¯æŒã€‚"},
  {"name":"Oola Field","zh_name":"Oola äº‹æ¥­","description":"æŠ•å…¥ä½¿å‘½èˆ‡å·¥ä½œã€‚"},
  {"name":"Oola Faith","zh_name":"Oola ä¿¡å¿µ","description":"ä¿¡ä»»èˆ‡æ›´é«˜æŒ‡å¼•ã€‚"},
  {"name":"Oola Friends","zh_name":"Oola å‹èª¼","description":"äººéš›å…±æŒ¯ã€‚"},
  {"name":"PanAway","zh_name":"èˆ’æ•","description":"èˆ’ç·©ã€ä¿®å¾©èˆ‡å¹³è¡¡ã€‚"},
  {"name":"Peace & Calming","zh_name":"èˆ’éœ","description":"å®‰æ’«æƒ…ç·’ï¼Œå¸¶ä¾†å¯§çœ ã€‚"},
  {"name":"Peace & Calming II","zh_name":"èˆ’éœ II","description":"å»¶ä¼¸ç‰ˆæœ¬ï¼Œå®‰å®šèˆ’å¿ƒã€‚"},
  {"name":"Present Time","zh_name":"ç•¶ä¸‹","description":"å›åˆ°æ­¤åˆ»ï¼Œå¢å¼·è‡¨åœ¨ã€‚"},
  {"name":"Purification","zh_name":"æ·¨åŒ–","description":"æ¸…æ–°ç©ºé–“èˆ‡å¿ƒéˆã€‚"},
  {"name":"R.C.","zh_name":"æ¨‚C","description":"æ¸…æ–°å‘¼å¸èˆ‡èƒ½é‡æµå‹•ã€‚"},
  {"name":"Raven","zh_name":"æ¨‚æŠ’","description":"æ‰“é–‹èƒ¸è‡†ï¼Œé †æš¢é‡‹æ”¾ã€‚"},
  {"name":"Relieve It","zh_name":"èˆ’è§£","description":"èˆ’ç·©æ²‰é‡æ„Ÿå—ã€‚"},
  {"name":"Release","zh_name":"é‡‹æ”¾","description":"é‡‹æ”¾è² è·ï¼Œå›åˆ°è¼•ç›ˆã€‚"},
  {"name":"RutaVaLa","zh_name":"èˆ’çœ ","description":"æ”¾é¬†èˆ‡å®‰ç¡æ”¯æŒã€‚"},
  {"name":"SARA","zh_name":"æ„›è‡ªå·±","description":"æƒ…æ„Ÿæ”¯æŒèˆ‡ä¿®å¾©ã€‚"},
  {"name":"Sacred Mountain","zh_name":"è–å±±","description":"ç©©å›ºå¦‚å±±ï¼Œç¥è–å®ˆè­·ã€‚"},
  {"name":"SclarEssence","zh_name":"èˆ’è¡¡","description":"å¥³æ€§å¹³è¡¡æ”¯æŒã€‚"},
  {"name":"Sensation","zh_name":"æ„Ÿå®˜","description":"å–šé†’æ„Ÿå®˜èˆ‡æ„›çš„èƒ½é‡ã€‚"},
  {"name":"Shutran","zh_name":"èˆ’ç”·","description":"ç”·æ€§è‡ªä¿¡èˆ‡é­…åŠ›ã€‚"},
  {"name":"Stress Away","zh_name":"æ¨‚è‡ªåœ¨","description":"æº«æŸ”èˆ’å£“èˆ‡æ”¾é¬†ã€‚"},
  {"name":"Thieves","zh_name":"ç›œè³Š","description":"ç¶“å…¸å®ˆè­·é…æ–¹ã€‚"},
  {"name":"3 Wise Men","zh_name":"ä¸‰ä½æ™ºè€…","description":"éˆæ€§æ™ºæ…§èˆ‡è¦ºé†’ã€‚"},
  {"name":"Trauma Life","zh_name":"å‰µå‚·é‡‹æ”¾","description":"æ·±å±¤é‡‹æ”¾èˆ‡ä¿®å¾©ã€‚"},
  {"name":"Tranquil","zh_name":"å¯§éœ","description":"å®‰å®šèˆ‡æ”¾é¬†ã€‚"},
  {"name":"Transformation","zh_name":"è½‰åŒ–","description":"æ”¯æŒè›»è®Šï¼Œèª¿æ•´é »ç‡ã€‚"},
  {"name":"Valor","zh_name":"å‹‡æ°£","description":"å…§åœ¨åŠ›é‡èˆ‡ç©©å›ºã€‚"},
  {"name":"Valor II","zh_name":"å‹‡æ°£ II","description":"å»¶ä¼¸ç‰ˆæœ¬ï¼Œç©©å¿ƒææŒ¯ã€‚"},
  {"name":"White Angelica","zh_name":"ç™½ä½¿è€…","description":"ç´”æ·¨å®ˆè­·èˆ‡è¢«æ„›æ„Ÿã€‚"},
  {"name":"White Light","zh_name":"ç™½å…‰","description":"æå‡ç´”æ·¨èˆ‡éˆæ€§é€£çµã€‚"},
  {"name":"AromaGuard Mountain Mint","zh_name":"å±±è–„è·é˜²è­·","description":"æ¸…æ–°å®ˆè­·ã€‚"},
  {"name":"AromaGuard Meadow Mist","zh_name":"è‰åŸè–„éœ§é˜²è­·","description":"è¼•æŸ”æ¸…æ–°ã€‚"},
  {"name":"GLF","zh_name":"GLF","description":"å”åŒæ”¯æŒï¼ˆå°ˆæ¥­ç”¨é€”ï¼‰ã€‚"},
  {"name":"ParaGize","zh_name":"èˆ’è…¸","description":"æº«å’Œèª¿ç†ã€æ”¾é¬†ã€‚"},
  {"name":"AromaLux (Blend for Diffuser)","zh_name":"AromaLux ç‰¹èª¿","description":"æ“´é¦™å„€å°ˆç”¨é…æ–¹ã€‚"},
  {"name":"Evergreen Essence","zh_name":"å¸¸é’ç²¾è¯","description":"æ£®æ—æ¸…æ–°ï¼Œå›æ­¸è‡ªç„¶ã€‚"},
  {"name":"Gentle Baby (EU)","zh_name":"æº«æŸ”å¯¶è²ï¼ˆæ­ç‰ˆï¼‰","description":"é…æ–¹è®Šé«”ï¼Œè¦ªå­å‹å–„ã€‚"},
  {"name":"Believe (2016)","zh_name":"ä¿¡å¿µï¼ˆ2016ï¼‰","description":"ç¶“å…¸æ–°ç‰ˆé…æ–¹ã€‚"},
  {"name":"Freedom","zh_name":"è‡ªç”±","description":"é‡‹æ”¾èˆ‡è¼•ç›ˆï¼ˆå¥—çµ„ï¼‰ã€‚"},
  {"name":"Gary's Light","zh_name":"è“‹ç‘ä¹‹å…‰","description":"éˆæ€§å•Ÿç™¼èˆ‡å®ˆè­·ã€‚"},
  {"name":"Journey On","zh_name":"å•Ÿç¨‹","description":"è‡´æ•¬æ—…äººç²¾ç¥èˆ‡å‹‡æ°£ã€‚"},
  {"name":"Loyalty","zh_name":"å¿ èª ","description":"å¹´åº¦æ„Ÿè¬ç‰¹èª¿ï¼ˆé™é‡ï¼‰ã€‚"},
  {"name":"Light The Fire","zh_name":"é»ç‡ƒä¹‹ç«","description":"é»ç‡ƒç†±æƒ…èˆ‡èƒ½é‡ã€‚"},
  {"name":"Live Your Passion","zh_name":"æ´»å‡ºç†±æƒ…","description":"å–šå›ç”Ÿå‘½ç†±åº¦ã€‚"},
  {"name":"One Heart","zh_name":"ä¸€å¿ƒ","description":"é€£çµã€æ…ˆæ‚²èˆ‡å…±å¥½ã€‚"},
  {"name":"One Voice","zh_name":"ä¸€éŸ³","description":"çœŸèª è¡¨é”èˆ‡å‹‡æ°£ã€‚"},
  /* KidScents */
  {"name":"KidScents TummyGize","zh_name":"è‚šè‚šå®‰","description":"å…’ç«¥èˆ’é©æ”¯æŒã€‚"},
  {"name":"KidScents SniffleEase","zh_name":"é¼»èˆ’","description":"è¼•é¬†å‘¼å¸ï¼Œæ¸…æ–°ã€‚"},
  {"name":"KidScents SleepyIze","zh_name":"ç¡ç¡å®‰","description":"å®‰ç¡èˆ‡æ”¾é¬†ã€‚"},
  {"name":"KidScents GeneYus","zh_name":"å¤©æ‰å¯¶è²","description":"å°ˆæ³¨èˆ‡å­¸ç¿’ã€‚"},
  {"name":"KidScents Owie","zh_name":"å“å”·","description":"æº«æŸ”ä¿®è­·ã€‚"},
  {"name":"KidPower","zh_name":"ç«¥åŠ›","description":"å‹‡æ°£èˆ‡è‡ªä¿¡ã€‚"},
  /* Animal Scents */
  {"name":"Animal Scents PuriClean","zh_name":"å¯µç‰©æ·¨æ½”ï¼ˆPuriCleanï¼‰","description":"æ¸…æ½”èˆ‡ä¿è­·ï¼ˆå‹•ç‰©ï¼‰"},
  {"name":"Animal Scents Infect Away","zh_name":"å¯µç‰©èˆ’è­·ï¼ˆInfect Awayï¼‰","description":"èª¿ç†èˆ‡å®ˆè­·ï¼ˆå‹•ç‰©ï¼‰"},
  {"name":"Animal Scents Mendwell","zh_name":"å¯µç‰©ä¿®å¾©ï¼ˆMendwellï¼‰","description":"æº«æŸ”ä¿®è­·ï¼ˆå‹•ç‰©ï¼‰"},
  /* Lady / æƒ…ç·’ç·š */
  {"name":"Lady Sclareol","zh_name":"å¥³å£«é­…åŠ›","description":"æº«æŸ”é­…åŠ›èˆ‡è‡ªä¿¡ã€‚"},
  {"name":"Surrender","zh_name":"è‡£æœ","description":"æ”¾ä¸‹æŠ—æ‹’ï¼Œå›åˆ°æµå‹•ã€‚"},
  {"name":"Believe (Roll-On)","zh_name":"ä¿¡å¿µéš¨èº«æ»¾ç ","description":"éš¨èº«ç‰ˆï¼ŒåŒèª¿ä¿¡å¿ƒã€‚"},
  {"name":"Stress Away (Roll-On)","zh_name":"æ¨‚è‡ªåœ¨éš¨èº«æ»¾ç ","description":"éš¨èº«èˆ’å£“ï¼Œè¼•é¬†æ”¾é¬†ã€‚"},
  {"name":"Deep Relief (Roll-On)","zh_name":"æ·±å±¤èˆ’ç·©æ»¾ç ","description":"å°ˆæ³¨èˆ’ç·©ï¼Œæ–¹ä¾¿æ”œå¸¶ã€‚"},
  /* Vitalityï¼ˆé£Ÿç”¨ç·šï¼Œç‚ºç›¸åŒè¤‡æ–¹ä¹‹é£Ÿç”¨æ¨™ç¤ºï¼‰ */
  {"name":"Citrus Fresh Vitality","zh_name":"å„ªæ©˜ï¼ˆé£Ÿç”¨ï¼‰","description":"æ¸…æ–°å£æ„Ÿï¼Œæ„‰æ‚…ã€‚"},
  {"name":"Longevity Vitality","zh_name":"é•·é’ï¼ˆé£Ÿç”¨ï¼‰","description":"æ—¥å¸¸è£œçµ¦ï¼ˆé£Ÿç”¨ç·šï¼‰ã€‚"}
];
// å»é‡ï¼ˆä»¥è‹±æ–‡åç‚º keyï¼‰
(function dedupeYL(){
  const seen=new Set(); const kept=[];
  for(const o of YL){ if(!seen.has(o.name)){ kept.push(o); seen.add(o.name);} }
  YL.length=0; Array.prototype.push.apply(YL,kept);
})();

function oilBlock(o){ return `<div class="card"><b>${o.name}</b>ï¼ˆ${o.zh_name||'â€”'}ï¼‰<div class="sm" style="margin-top:6px">${o.description||''}</div></div>`; }
function pickTodayOils(vals){
  const box=document.getElementById('oilBox');
  if(!vals || !vals.length){ box.textContent='è«‹å…ˆå®Œæˆé‡è¡¨ä¸¦ç”Ÿæˆé›·é”åœ–ã€‚'; return; }
  const list = vals.map((v,i)=>({i,v})).sort((a,b)=>a.v-b.v); // ä½â†’é«˜
  const idxs = [list[0].i, list[1].i]; // å…©å€‹æœ€ä½
  // æ—¥æœŸç¨®å­ä¿è­‰åŒæ—¥ç©©å®š
  const seed = parseInt(new Date().toISOString().slice(0,10).replace(/-/g,''),10);
  function seededRand(i){ return (Math.sin(seed+i)*10000)%1; }
  const picks = [];
  idxs.forEach((ix,k)=>{
    const pool = YL;
    const pickIndex = Math.floor(Math.abs(seededRand(ix+k))*pool.length);
    picks.push(pool[pickIndex]);
  });
  // ç¬¬ä¸‰æ”¯ä½œç‚ºåŠ å€¼ï¼ˆå¶æ•¸æ—¥å‡ºç¾ï¼‰
  if (seed % 2 === 0){
    picks.push(YL[Math.floor(Math.abs(seededRand(99))*YL.length)]);
  }
  box.innerHTML = picks.map(oilBlock).join('');
}

/* æœå°‹åŠŸèƒ½ï¼ˆä¸­è‹±ï¼‰ */
document.getElementById('oilSearch').addEventListener('input', (e)=>{
  const q=e.target.value.trim().toLowerCase();
  const box=document.getElementById('oilBox');
  if(!q){ const prev=JSON.parse(localStorage.getItem('e7_scores_v1')||'[]'); return pickTodayOils(prev); }
  const hits = YL.filter(o=>(o.name.toLowerCase().includes(q) || (o.zh_name||'').toLowerCase().includes(q)));
  box.innerHTML = hits.length ? hits.slice(0,50).map(oilBlock).join('') : '<div class="sm">æ‰¾ä¸åˆ°ç›¸ç¬¦ç²¾æ²¹</div>';
});
document.getElementById('swapOil').addEventListener('click',()=>pickTodayOils(JSON.parse(localStorage.getItem('e7_scores_v1')||'[]')));

/* =========================
   æ—…ç¨‹ï¼šæ¯æ—¥ä¸€æ¬¡æ‰“å¡ + è§£é–å‹•ç•« + éš±è—éˆé­‚å¡ï¼ˆ33ï¼‰
   ========================= */
const LSKEY = "enervi7_journey_v3_full";
const S = (k,d)=>{ try{return JSON.parse(localStorage.getItem(k)??JSON.stringify(d));}catch(e){return d;} };
const W = (k,v)=>localStorage.setItem(k, JSON.stringify(v));
const state = S(LSKEY, { d7:0,d21:0,d30:0, last:null, unlocked7:false,unlocked21:false,unlocked30:false, idx:0 });

function today(){ return new Date().toISOString().slice(0,10); }
function toast(msg){
  const t=document.createElement('div'); t.className='toast'; t.textContent=msg;
  document.body.appendChild(t); setTimeout(()=>{t.style.transition='opacity .35s'; t.style.opacity='0'; setTimeout(()=>t.remove(),380)},1100);
}
function renderJourney(){
  d7.textContent=state.d7; d21.textContent=state.d21; d30.textContent=state.d30;
  p7.style.width=Math.min(state.d7/7*100,100)+'%';
  p21.style.width=Math.min(state.d21/21*100,100)+'%';
  p30.style.width=Math.min(state.d30/30*100,100)+'%';
  const done = state.last===today();
  tick7.checked=done; tick21.checked=done; tick30.checked=done;
  setBadge(b7,state.unlocked7); setBadge(b21,state.unlocked21); setBadge(b30,state.unlocked30);
}
function setBadge(el,unlocked){
  el.classList.remove('unlock');
  if(unlocked){
    el.classList.remove('locked'); el.classList.add('unlocked','unlock');
    el.innerHTML = `<svg viewBox="0 0 24 24" fill="none"><path d="M17 10V7a5 5 0 10-10 0h2a3 3 0 116 0v3h-1a2 2 0 00-2 2v8a2 2 0 002 2h4a2 2 0 002-2v-8a2 2 0 00-2-2h-1z" fill="#c7b6ff"/></svg>`;
    setTimeout(()=>el.classList.remove('unlock'),1400);
  }else{
    el.classList.add('locked'); el.classList.remove('unlocked');
    el.innerHTML = `<svg viewBox="0 0 24 24" fill="none"><path d="M12 2a5 5 0 00-5 5v3H6a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2v-8a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2a3 3 0 013 3v3H9V7a3 3 0 013-3z" fill="#9a96c7"/></svg>`;
  }
}
function unlockIf(){ // åˆ¤å®šè§£é– & é¡¯ç¤ºå¡
  const hits=[];
  if(state.d7===7 && !state.unlocked7){ state.unlocked7=true; hits.push(7); }
  if(state.d21===21 && !state.unlocked21){ state.unlocked21=true; hits.push(21); }
  if(state.d30===30 && !state.unlocked30){ state.unlocked30=true; hits.push(30); }
  if(hits.length){ showHiddenCard(); }
}
function checkin(){
  if(state.last===today()){ toast('ä»Šå¤©å·²æ‰“å¡ âœ¨'); return; }
  state.last=today();
  state.d7 = Math.min(state.d7+1,7);
  state.d21= Math.min(state.d21+1,21);
  state.d30= Math.min(state.d30+1,30);
  unlockIf();
  W(LSKEY,state); renderJourney();
  if(!(state.d7===7||state.d21===21||state.d30===30)) toast('âœ… å·²è¨˜éŒ„ä»Šæ—¥æ‰“å¡');
}
[tick7,tick21,tick30].forEach(el=>el.addEventListener('change',e=>{ if(e.target.checked) checkin(); else renderJourney(); }));

/* éš±è—éˆé­‚å¡ï¼ˆ33ï¼‰ */
const HIDDEN_CARDS = [
  {t:"å…‰çš„ä¾†æº", m:"ä½ ä¸æ˜¯ç‚ºäº†è¢«é»äº®ï¼Œè€Œæ˜¯å–šé†’æ²‰ç¡çš„éˆé­‚ã€‚\nè¡Œå‹•ï¼šæŠŠæ³¨æ„åŠ›æ”¾åœ¨ã€æˆ‘å·²ç¶“åœ¨ç™¼å…‰ã€çš„ä¸€ä»¶å°äº‹ä¸Šã€‚"},
  {t:"æˆç‚º", m:"ä½ æ²’æœ‰è®Šå¾—æ›´å¥½ï¼Œåªæ˜¯è®Šå¾—æ›´çœŸã€‚"},
  {t:"çœŸç†ä¹‹å…‰", m:"çœŸç†ä¸æ˜¯ç†è§£å¾Œæ‰å­˜åœ¨ï¼Œè€Œæ˜¯ä½ æ”¾ä¸‹å¾Œé‚„åœ¨çš„é‚£å€‹æ±è¥¿ã€‚"},
  {t:"æ„›çš„å…‰æº", m:"æˆ‘çš„å¿ƒä¸æ˜¯å€‰åº«ï¼Œè€Œæ˜¯å¤ªé™½ã€‚"},
  {t:"éœé»˜ä¹‹å…‰", m:"éœé»˜ä¸æ˜¯ç©ºç™½ï¼Œæ˜¯èªè¨€ä¹‹å‰çš„å®Œæ•´ã€‚"},
  {t:"è‡£æœä¹‹å…‰", m:"è‡£æœä¸æ˜¯å¤±å»åŠ›é‡ï¼Œè€Œæ˜¯ä¸å†èˆ‡æµå°æŠ—ã€‚"},
  {t:"è¨˜å¾—ä¹‹å…‰", m:"ä½ ä¸æ˜¯åœ¨å°‹æ‰¾ï¼Œè€Œæ˜¯åœ¨è¨˜å¾—ã€‚"},
  {t:"å‰µé€ ä¹‹å…‰", m:"å‰µé€ ä¸æ˜¯ä½ åšäº†ä»€éº¼ï¼Œè€Œæ˜¯ä½ å…è¨±ä»€éº¼ç¶“ç”±ä½ è€Œä¾†ã€‚"},
  {t:"å®Œæˆä¹‹å…‰", m:"å®Œæˆä¸æ˜¯çµæŸï¼Œè€Œæ˜¯å›åˆ°æœ¬æºã€‚"},
  {t:"è‡ªç”±ä¹‹å…‰", m:"è‡ªç”±ä¸æ˜¯é€ƒé›¢ï¼Œè€Œæ˜¯ä¸å†å£“æŠ‘çœŸå¯¦çš„è‡ªå·±ã€‚"},
  {t:"æ­¸ä¾†ä¹‹å…‰", m:"ä½ ä¸€ç›´éƒ½åœ¨é€™è£¡ï¼Œä¸€ç›ç‡ˆéœéœäº®è‘—ã€‚"},
  {t:"ç„¡åä¹‹å…‰", m:"åœ¨éœ€è¦åå­—ä¹‹å‰ï¼Œä½ å·²ç¶“æ˜¯å…‰ã€‚"},
  {t:"è¦ºå¯Ÿ", m:"çœ‹è¦‹æ­£åœ¨ç™¼ç”Ÿçš„ï¼Œä¸æ€¥è‘—è©•åƒ¹ã€‚"},
  {t:"é‡‹æ”¾", m:"é¬†é–‹æ‰‹ï¼Œè®“èƒ½é‡å›åˆ°æµå‹•ã€‚"},
  {t:"ä¿¡ä»»", m:"å…è¨±è¢«æ”¯æŒï¼Œå…è¨±æ›´å¤§çš„å–„å±•é–‹ã€‚"},
  {t:"è¡Œå‹•", m:"æœ€å°å¯è¡Œçš„ä¸€æ­¥ï¼Œç«‹åˆ»é€²å ´ã€‚"},
  {t:"æµå‹•", m:"å°ˆæ³¨â€”å›é¥‹â€”å¾®èª¿â€”å†å°ˆæ³¨ã€‚"},
  {t:"å…±é³´", m:"æŠŠåƒ¹å€¼é€å‡ºå»ï¼Œå›è²æœƒå‘Šè¨´ä½ è·¯ã€‚"},
  {t:"æ•´åˆ", m:"æŠŠæœ‰æ•ˆå›ºåŒ–æˆçµæ§‹ï¼Œè®“ç¯€å¥å»¶çºŒã€‚"},
  {t:"å…è¨±ä¼‘æ¯", m:"ä¼‘æ¯ä¸æ˜¯é€€å¾Œï¼Œæ˜¯èƒ½é‡å›å……ã€‚"},
  {t:"é‚Šç•Œ", m:"ç•Œç·šæ˜¯å°è‡ªå·±èˆ‡ä»–äººçš„æ¸…æ™°ã€‚"},
  {t:"å°ˆæ³¨", m:"ä½ å°ˆæ³¨çš„åœ°æ–¹ï¼Œå°±æ˜¯èƒ½é‡ç”Ÿé•·çš„åœ°æ–¹ã€‚"},
  {t:"å‹‡æ°£", m:"å¸¶è‘—æ€•ä¹Ÿå‰è¡Œï¼Œå°±æ˜¯å‹‡æ°£ã€‚"},
  {t:"æ„Ÿæ©", m:"æ„Ÿæ©è®“è±ç››çœ‹å¾—è¦‹ã€‚"},
  {t:"æ¾„æ˜", m:"æ¸…æ™°ä¾†è‡ªçœ‹è¦‹ï¼Œä¹Ÿä¾†è‡ªæ”¾ä¸‹é›œè¨Šã€‚"},
  {t:"å°é½Š", m:"ç•¶æ„åœ–å°é½Šï¼Œè·¯å¾‘æœƒè‡ªå·±é¡¯ç¾ã€‚"},
  {t:"å…è¨±å–œæ‚…", m:"å¿«æ¨‚ä¸æ˜¯æˆæœï¼Œæ˜¯æ–¹æ³•ã€‚"},
  {t:"æŠŠæ‰‹é¬†é–‹", m:"é¬†é–‹ä¸æ˜¯å¤±å»ï¼Œæ˜¯ç‚ºæ¥ä½åšæº–å‚™ã€‚"},
  {t:"ç‚ºè‡ªå·±ä½œè­‰", m:"å¯«ä¸‹ 3 å€‹ã€æˆ‘åšåˆ°äº†ã€ã€‚"},
  {t:"æ²‰è‘—çš„å¿ƒ", m:"æ…Œåªæ˜¯æš«æ™‚ï¼›æ·±è™•ä¸€ç›´å¾ˆç©©ã€‚"},
  {t:"å…ˆç›¸ä¿¡", m:"ä¸æ˜¯å› ç‚ºçœ‹è¦‹æ‰ç›¸ä¿¡ï¼Œè€Œæ˜¯ç›¸ä¿¡æ‰€ä»¥çœ‹è¦‹ã€‚"},
  {t:"å›å®¶", m:"æ­¸è¿”ï¼Œä¸å¿…é è¡Œã€‚"},
  {t:"åŒè¡Œ", m:"æŠŠä»Šå¤©åˆ†äº«çµ¦ä¸€å€‹äººï¼Œè·¯æœƒè®Šäº®ã€‚"},
  {t:"è¨±å¯", m:"å‡†è¨±è‡ªå·±æ˜¯ç¾åœ¨é€™æ¨£ï¼Œä¸–ç•Œæ‰å¥½å¥½æ„›ä½ ã€‚"}
];
function showHiddenCard(){
  const idx = state.idx % HIDDEN_CARDS.length;
  const card = HIDDEN_CARDS[idx];
  state.idx = idx+1; W(LSKEY,state);
  cardTitle.textContent = `ğŸ§¿ ${card.t}`;
  cardText.textContent  = card.m;
  unlockDlg.showModal();
}

/* =========================
   åˆå§‹åŒ–ï¼šæ—…ç¨‹ã€ç¥è«­ã€è‹¥æœ‰èˆŠåˆ†æ•¸å‰‡é‡ç•«é›·é”/å¡
   ========================= */
function saveScores(vals){ localStorage.setItem('e7_scores_v1', JSON.stringify(vals)); }
function loadScores(){ try{ return JSON.parse(localStorage.getItem('e7_scores_v1')||'[]'); }catch{return []} }

document.getElementById('genRadar').addEventListener('click',()=>{
  const vals=computeStageAverages();
  drawRadar(vals); renderInfoCards(vals); saveScores(vals); pickTodayOils(vals);
});
function boot(){
  renderJourney();
  drawOracle(false);
  const prev=loadScores();
  if(prev.length){ drawRadar(prev); renderInfoCards(prev); pickTodayOils(prev); }
}
boot();
</script>

<!-- PWAï¼ˆå¦‚éœ€ï¼Œå¯è‡ªè¡ŒåŠ å…¥ sw.js èˆ‡ manifestï¼›æœ¬æª”ä¸å¼·åˆ¶ï¼‰ -->
</body>
</html>