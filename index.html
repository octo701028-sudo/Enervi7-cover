<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Enervi7 • v7 Full (Single File)</title>
<meta name="theme-color" content="#6A46FF"/>
<style>
:root{
  --bg:#0e0f16;--card:#141624;--muted:#a9a9bb;--text:#e9e9f4;--line:#2b2e44;
  --accent:#8a6bff;--accent2:#6ae0ff;--ok:#49e1a6;--warn:#ffb86b;
}
*{box-sizing:border-box}html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,"PingFang TC","Noto Sans TC",sans-serif;}
.wrap{max-width:880px;margin:0 auto;padding:0 16px}
.header{position:sticky;top:0;z-index:9;padding:28px 0 18px;background:radial-gradient(1200px 240px at 50% -120px,rgba(138,107,255,.35),transparent 60%),linear-gradient(180deg,#1b1436,#131524);border-bottom:1px solid #201d33}
h1{margin:0;font-weight:900;font-size:32px;background:linear-gradient(90deg,#c6b9ff,#8a6bff,#6ae0ff);-webkit-background-clip:text;background-clip:text;color:transparent;letter-spacing:.5px}
.kv{margin-top:10px;display:flex;gap:12px;flex-wrap:wrap}
.badge{display:inline-flex;align-items:center;gap:6px;padding:8px 14px;border-radius:999px;background:#1b1e2f;border:1px solid #2b2e44;color:#cfd2ff;font-weight:600;font-size:13px}
.small{color:var(--muted);font-size:13px}
.section{background:var(--card);border:1px solid var(--line);padding:18px;border-radius:16px;box-shadow:0 10px 24px rgba(0,0,0,.25);margin:18px 0}
h2{margin:0 0 12px 0;font-size:20px}
.row{display:flex;align-items:center;gap:12px;justify-content:space-between}
.btn{cursor:pointer;border:1px solid #3a3870;background:linear-gradient(180deg,#6f66ff,#624ef7);padding:10px 14px;color:#fff;border-radius:12px;font-weight:700}
.btn.secondary{background:#232641;color:#cfd2ff;border:1px solid #383b6a}
.lock{width:72px;height:72px;border-radius:50%;display:grid;place-items:center;background:#111422;border:1px solid #2b2e44;box-shadow:inset 0 0 0 0 rgba(106,224,255,.0);transition:.6s}
.lock svg{opacity:.8}
.lock.unlock{border-color:#70e9ff;box-shadow:0 0 0 6px rgba(106,224,255,.08),0 0 28px 6px rgba(106,224,255,.22), inset 0 0 40px rgba(106,224,255,.25);}
.progress{height:8px;background:#1b1e2f;border:1px solid #2b2e44;border-radius:8px;overflow:hidden}
.progress>span{display:block;height:100%;background:linear-gradient(90deg,#6ae0ff,#8a6bff);width:0%}
.kpi{color:var(--muted);font-size:14px;margin-bottom:10px}
.grid{display:grid;gap:16px}
@media(min-width:760px){.grid{grid-template-columns:1fr 1fr 1fr}}
blockquote{margin:12px 0 0;border-left:4px solid #3846ff;padding:8px 12px;color:#cfd2ff;background:#12142a;border-radius:8px}
.card{background:var(--card);border:1px solid var(--line);padding:12px;border-radius:12px}
#radar{width:100%;max-width:560px;height:auto;display:block;margin:10px auto}
label.slider{display:block;margin:12px 0}
label.slider .v{float:right;color:#aab}
input[type=range]{width:100%}
.ok{color:var(--ok)} .warn{color:var(--warn)}
.oracle{white-space:pre-wrap}
.footer{color:var(--muted);font-size:12px;text-align:center;margin:18px 0 40px}
</style>
</head>
<body>
<header class="header">
  <div class="wrap">
    <h1>Enervi7</h1>
    <div class="kv">
      <span class="badge">離線可用</span>
      <span class="badge">不依賴外部 CDN</span>
      <span class="badge">單檔部署</span>
    </div>
  </div>
</header>

<main class="wrap">
  <section class="section">
    <h2>🌀 旅程進度</h2>
    <div class="grid">
      <div class="card">
        <div class="kpi">7 日能量挑戰</div>
        <div class="progress"><span id="p7"></span></div>
        <div class="row" style="margin-top:10px">
          <small class="small"><span id="t7"></span></small>
          <button class="btn" id="btn7">完成今日打卡</button>
          <div id="lock7" class="lock" title="連續 7 日解鎖">
            <svg width="28" height="36" viewBox="0 0 24 24" fill="none" stroke="#9aa3ff" stroke-width="2"><path d="M7 10V7a5 5 0 0 1 10 0v3"/><rect x="5" y="10" width="14" height="10" rx="2" ry="2"/></svg>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="kpi">21 日靈魂轉化</div>
        <div class="progress"><span id="p21"></span></div>
        <div class="row" style="margin-top:10px">
          <small class="small"><span id="t21"></span></small>
          <button class="btn" id="btn21">完成今日打卡</button>
          <div id="lock21" class="lock" title="連續 21 日解鎖">
            <svg width="28" height="36" viewBox="0 0 24 24" fill="none" stroke="#9aa3ff" stroke-width="2"><path d="M7 10V7a5 5 0 0 1 10 0v3"/><rect x="5" y="10" width="14" height="10" rx="2" ry="2"/></svg>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="kpi">30 日顯化日記</div>
        <div class="progress"><span id="p30"></span></div>
        <div class="row" style="margin-top:10px">
          <small class="small"><span id="t30"></span></small>
          <button class="btn" id="btn30">完成今日打卡</button>
          <div id="lock30" class="lock" title="連續 30 日解鎖">
            <svg width="28" height="36" viewBox="0 0 24 24" fill="none" stroke="#9aa3ff" stroke-width="2"><path d="M7 10V7a5 5 0 0 1 10 0v3"/><rect x="5" y="10" width="14" height="10" rx="2" ry="2"/></svg>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <h2>🧭 14 題量表（0–10）</h2>
    <div id="qs"></div>
    <div class="row">
      <button id="genRadar" class="btn">生成能量圖</button>
      <small class="small">目前平均分會反映到下方資訊卡。</small>
    </div>
  </section>

  <section class="section">
    <h2>📈 能量雷達圖</h2>
    <svg id="radar" viewBox="0 0 420 420"></svg>
  </section>

  <section class="section">
    <h2>📜 呢喃神諭（Whispering Oracle）</h2>
    <div id="oracleBox" class="oracle"></div>
    <div class="row" style="margin-top:8px">
      <button id="drawOracle" class="btn secondary">抽一張</button>
      <small class="small">同一天僅顯示一張；隔天自動刷新。</small>
    </div>
  </section>

  <section class="section">
    <h2>🪔 今日建議精油</h2>
    <div id="oilBox" class="small">請先完成量表並產出雷達圖。</div>
    <div class="row" style="margin-top:8px">
      <button id="swapOil" class="btn secondary">換一款（示意）</button>
      <small class="small">顯示：英文名稱（官方中文）＋能量描述。</small>
    </div>
  </section>

  <section class="section">
    <h2>🌈 七階資訊卡（自動展開最低兩階）</h2>
    <div id="infoCards"></div>
  </section>

  <p class="footer">© Enervi7 — 單檔離線版</p>
</main>

<script>
/* ===================== 問卷題目（14 題 × 7 階） ===================== */
const PHASES = [
  { key:'白', title:'能量覺知',  k:['覺知當下','辨識情緒','看見模式','誠實面對'],
    act:['寫三句「此刻我真實的感受是…」','3 分鐘腹式呼吸（4-4-6）並記錄身體感受','列出 1 個反覆出現的念頭，標記：是事實還是解讀？'] },
  { key:'藍', title:'穩定與淨化', k:['穩定','釋放','界線','沉澱'],
    act:['寫下最困擾你的 1 件事，標註可控／不可控','5 分鐘靜坐，專注呼吸','清理一個小角落／檔案夾'] },
  { key:'橙', title:'能量流動',   k:['專注','回饋循環','韌性','迭代'],
    act:['把卡點→調整 1 個微策略（A/B 嘗試）','25 分鐘番茄鐘全程專注','記錄 1 個有效回饋，明天沿用'] },
  { key:'黃', title:'內在力量',   k:['自信','邊界','選擇權','行動意志'],
    act:['完成一件 10 分鐘可達成的小事','設定今日 3 件 MIT','把一項目標拆成可驗證步驟'] },
  { key:'綠', title:'共振與連結', k:['連結','價值感','貢獻','擴散'],
    act:['分享一個小成果或洞見到社群／朋友','邀請 1 人給具體回饋（3 句具體描述）','主動建立一個合作可能（發出一則邀請）'] },
  { key:'藍藍', title:'意識擴展', k:['視野','直覺','洞見','學習'],
    act:['今天閱讀 10 分鐘並記 3 句重點','把一個問題寫成 2 種假說','觀察一個日常模式並命名它'] },
  { key:'紫', title:'靈魂整合',  k:['總結經驗','固化習慣','結構化','長期化'],
    act:['用 5 句話摘要本週 3 件學到＋1 改進','把有效步驟寫成 Checklist 並固定到行程','為下個週期設定一個可衡量指標（KPI）'] }
];
const QUESTIONS = [
  '我能清楚覺察自己此刻的身心狀態。','我能在混亂時，迅速把注意力帶回當下。',
  '面對壓力或衝突時，我能保持冷靜不失衡。','我能有效地釋放累積的負面情緒與雜念。',
  '我常感覺靈感／情感在體內自然流動。','遇到阻礙時，我能做出小幅度且持續的調整。',
  '我能信任自己的判斷，並持續做出選擇。','遇到挑戰，我仍能相信自己並往前一步。',
  '我能真誠表達，也樂於傾聽他人。','我能感到自己與他人、與世界是連結的。',
  '我能任直覺，且能從中獲得有用的指引。','我能從日常事件看見更深的洞見與意義。',
  '我能把過去的經驗整合成力量，而不是枷鎖。','我常感到自己完整，對生命方向踏實安心。'
];
/* 產生題目 */
const qsBox = document.getElementById('qs');
const SLIDE_IDS = [];
(function renderQs(){
  PHASES.forEach((ph,pi)=>{
    for(let j=0;j<2;j++){
      const i = pi*2+j;
      const id = 'q'+i;
      SLIDE_IDS.push(id);
      const lab = document.createElement('label'); lab.className='slider';
      lab.innerHTML = `<strong>${pi+1+j===0?1:i+1}. ${ph.key}｜${ph.title}</strong> ${QUESTIONS[i]} <span class="v">目前：<b id="${id}_v">5</b> / 10</span>
      <input id="${id}" type="range" min="0" max="10" step="1" value="5"/>`;
      qsBox.appendChild(lab);
    }
  });
  SLIDE_IDS.forEach(id=>{
    const el = document.getElementById(id), v=document.getElementById(id+'_v');
    el.addEventListener('input',()=>v.textContent=el.value);
  });
})();

/* ===================== Radar (SVG) ===================== */
function drawRadar(vals){
  const svg = document.getElementById('radar'); svg.innerHTML='';
  const cx=210, cy=210, r=160, n=7;
  function polar(a,m){ return [cx + Math.sin(a)*m, cy - Math.cos(a)*m]; }
  // grid
  for(let k=1;k<=4;k++){
    const m=r*k/4; const p=[]; for(let i=0;i<n;i++){const a=i*2*Math.PI/n; p.push(polar(a,m));}
    const d='M'+p.map(x=>x.join(',')).join('L')+'Z';
    const g=document.createElementNS('http://www.w3.org/2000/svg','path');
    g.setAttribute('d',d); g.setAttribute('fill','none'); g.setAttribute('stroke','#2b2e44'); g.setAttribute('stroke-width','1');
    svg.appendChild(g);
  }
  // axis + labels
  PHASES.forEach((ph,i)=>{
    const a=i*2*Math.PI/7; const [x,y]=polar(a,r);
    const ax=document.createElementNS('http://www.w3.org/2000/svg','line');
    ax.setAttribute('x1',cx); ax.setAttribute('y1',cy); ax.setAttribute('x2',x); ax.setAttribute('y2',y);
    ax.setAttribute('stroke','#2b2e44'); ax.setAttribute('stroke-width','1'); svg.appendChild(ax);
    const lb=document.createElementNS('http://www.w3.org/2000/svg','text');
    lb.setAttribute('x',x); lb.setAttribute('y',y); lb.setAttribute('fill','#a9a9bb'); lb.setAttribute('font-size','12');
    lb.setAttribute('text-anchor','middle'); lb.textContent=ph.key+'｜'+ph.title; svg.appendChild(lb);
  });
  // area
  const max=10; const ps=[];
  for(let i=0;i<7;i++){
    const a=i*2*Math.PI/7; const m=r*(vals[i]/max); ps.push(polar(a,m));
  }
  const d='M'+ps.map(p=>p.join(',')).join('L')+'Z';
  const area=document.createElementNS('http://www.w3.org/2000/svg','path');
  area.setAttribute('d',d); area.setAttribute('fill','rgba(138,107,255,.28)'); area.setAttribute('stroke','#8a6bff'); area.setAttribute('stroke-width','2');
  svg.appendChild(area);
}

/* ===================== 七階資訊卡 ===================== */
function renderInfoCards(vals){
  const box=document.getElementById('infoCards');
  const withAvg = PHASES.map((p,i)=>({i,avg:(vals[i*2]+vals[i*2+1])/2}));
  const sorted=[...withAvg].sort((a,b)=>a.avg-b.avg).slice(0,2).map(x=>x.i);
  box.innerHTML = sorted.map(i=>{
    const ph=PHASES[i];
    return `<div class="card" style="margin:10px 0">
      <div class="kpi">${ph.key}｜${ph.title}｜平均 <b>${((vals[i*2]+vals[i*2+1])/2).toFixed(1)}</b> 分</div>
      <div class="small">關鍵字： ${ph.k.map(t=>`<span class="badge" style="padding:4px 10px;background:#191b2b;border-color:#2b2e44">${t}</span>`).join(' ')}</div>
      <h3 style="margin:10px 0 6px;font-size:16px">行動建議</h3>
      <ul style="margin:0 0 4px 18px;padding:0">${ph.act.map(t=>`<li>${t}</li>`).join('')}</ul>
    </div>`;
  }).join('');
}

/* ===================== 分數計算 & 本地保存 ===================== */
function collectVals(){
  return SLIDE_IDS.map(id=>+document.getElementById(id).value);
}
function toPhaseMeans(raw){ // 14 -> 7 averages
  return PHASES.map((_,i)=> (raw[i*2]+raw[i*2+1])/2 );
}
function saveScores(raw){
  localStorage.setItem('enervi7_scores', JSON.stringify({t:Date.now(), raw}));
}
function loadLastScores(){
  try{ const o = JSON.parse(localStorage.getItem('enervi7_scores')||'{}'); return Array.isArray(o.raw)?o.raw:[]; }catch(e){return [];}
}

/* ===================== Oracle（每日一張） ===================== */
const ORACLE = [
  {t:'歸來', p:'你走過萬里，原來一直都在這裡。', a:'今天，對自己說：我已經回來了。'},
  {t:'成為', p:'你沒有變得更好，只是變得更真。', a:'允許自己出現，哪怕只是 1 分鐘。'},
  {t:'容納', p:'你不是湖面，而是湖。', a:'當情緒來時，請為它留一把椅子。'},
  {t:'看見', p:'看見就已改變。', a:'把當下最明亮的 1 件事寫下來。'},
  {t:'交托', p:'不是交給誰，而是交回給生命。', a:'今天練習放手 1 件微小之事。'},
  {t:'重生', p:'每次呼吸都是新的。', a:'做 10 次慢吸慢吐，說：我願意開始。'},
  {t:'熄燈', p:'讓舞台暗下，才能看見星光。', a:'今晚提早 30 分鐘休息。'},
  {t:'點燈', p:'你就是火苗。', a:'點一盞小燈，為自己祈願。'},
  {t:'合一', p:'你以為的缺口，是通往宇宙的門。', a:'今天對自己說：我足夠了。'},
  {t:'微笑', p:'請把臉朝向光。', a:'對路上的人送出 1 次微笑。'},
  {t:'深根', p:'你不必抓緊，因為你已經連結。', a:'赤腳站立 60 秒，感覺腳底的地心。'},
  {t:'回響', p:'宇宙總會回信。', a:'寫下你今天收過的 1 份回饋。'},
  {t:'信步', p:'先走一步，路便出現。', a:'完成一件 5–10 分鐘的微行動。'},
  {t:'軟化', p:'越柔軟，越有力。', a:'用更溫柔的語氣對自己說話。'},
  {t:'清明', p:'清明不是空白，是清澈。', a:'喝一杯白開水，深呼吸 3 次。'},
  {t:'初心', p:'不是回到起點，而是記起光。', a:'今天做一件你曾熱愛的小事。'},
  {t:'邀請', p:'當你願意，世界會靠近。', a:'向 1 人發出真誠的邀請。'},
  {t:'停駐', p:'停下，也是一種前進。', a:'把手機放下 10 分鐘，單純坐著。'},
  {t:'鏡湖', p:'世界是你的映照。', a:'觀察一個觸發點，只寫觀察不下結論。'},
  {t:'承載', p:'你承載得起你的願望。', a:'寫下你想承接的 1 份禮物。'},
  {t:'滋長', p:'溫柔照料，便會長大。', a:'澆一盆植物／照顧自己 5 分鐘。'},
  {t:'相逢', p:'靈魂與靈魂總有暗號。', a:'寫信給未來的自己（1 句）。'},
  {t:'定星', p:'請把視線放到更遠的地方。', a:'寫下 1 個最重要的方向。'},
  {t:'破曉', p:'黑暗從來不是對立，只是循環。', a:'晨起拉開窗簾，迎接今日第一道光。'},
  {t:'守候', p:'願你的等待有回聲。', a:'把一件想做的事排在日曆上。'},
  {t:'提燈', p:'你也是別人的光。', a:'分享一個小小的有用訊息。'},
  {t:'聚焦', p:'一束光，可以穿透。', a:'今天只做 3 件最重要的事。'},
  {t:'綻放', p:'請允許自己被看見。', a:'發布一件完成品，哪怕不完美。'},
  {t:'呼應', p:'你給出的，會回到你身上。', a:'說一聲謝謝，並感受它。'},
  {t:'無名', p:'在還需要名字之前，你已經是光。', a:'靜默 60 秒，讓自己被看見。'},
  {t:'羽化', p:'不是離開，而是展翼。', a:'今天走出門，多走 500 步。'},
  {t:'守護', p:'你一直被看顧。', a:'擁抱自己 10 秒鐘。'},
  {t:'踏浪', p:'害怕也能前進。', a:'完成 1 件你有點怕的事（很小也可以）。'},
  {t:'溪流', p:'讓它流過，你就自由。', a:'寫下你願意放下的 1 件事。'},
  {t:'聆聽', p:'答案在靜默裡。', a:'今天給自己 5 分鐘安靜。'},
  {t:'開門', p:'門從來都在。', a:'對世界說：我準備好了。'},
  {t:'修復', p:'裂縫會長出花。', a:'列一件你已經做得不錯的事情。'},
  {t:'回家', p:'回到身體，回到心裡。', a:'做 1 分鐘身體掃描。'},
  {t:'流光', p:'時間是朋友。', a:'整理相簿，挑 1 張讓你溫暖的照片。'},
  {t:'專注', p:'專注使光變成雷射。', a:'本日一個 25 分鐘番茄鐘。'},
  {t:'感恩', p:'萬物皆回饋。', a:'寫下今天值得感謝的 3 件事。'},
  {t:'信任', p:'請信任正在發生的一切。', a:'告訴自己：我被支持。'},
  {t:'自由', p:'自由不是沒有邊界，而是內在有選擇。', a:'對一件事說「我選擇」。'}
]; // 44

/* ===================== 隱藏靈魂卡（33） ===================== */
const HIDDEN_CARDS = [
  {t:'無名之光', p:'在你還需要名字之前，你已經是光。', a:'今天，靜默 60 秒，讓自己被看見。'},
  {t:'湖心', p:'越靠近中央，越安靜。', a:'用 3 次深呼吸回到中心。'},
  {t:'山脈', p:'你的穩定讓世界安心。', a:'挺直背脊行走 1 分鐘。'},
  {t:'海潮', p:'來去自如的力量。', a:'用 30 秒觀察吸氣與吐氣的潮汐。'},
  {t:'火種', p:'你內在仍然溫熱。', a:'完成最小的那一步。'},
  {t:'星圖', p:'你在尋路，也在畫路。', a:'把今日方向寫成一句話。'},
  {t:'窗',  p:'打開，就有風。', a:'打開窗戶 20 秒，換氣。'},
  {t:'橋',  p:'連結不是擁有，是通行。', a:'主動發出一個問候。'},
  {t:'石',  p:'沉著讓你擁有重量。', a:'今天說話比平常慢一點。'},
  {t:'雨',  p:'允許，便是滋養。', a:'喝一杯水，感覺它進入身體。'},
  {t:'圓',  p:'終章亦是序章。', a:'寫下下一輪的意圖。'},
  {t:'線',  p:'把鬆散的東西串起來。', a:'建立一個 checklist。'},
  {t:'嶺',  p:'面向群峰，便知自己的位置。', a:'回顧 1 件收穫並致謝。'},
  {t:'舟',  p:'你不必成為海，做一葉舟就好。', a:'把擔子卸下一小塊。'},
  {t:'泉',  p:'清澈是你的天性。', a:'今天簡化一件事。'},
  {t:'燈塔',p:'因為你在，別人不會迷路。', a:'分享一個你確定有用的資訊。'},
  {t:'種子',p:'每一次休息都是發芽前的夜。', a:'今晚提早 15 分鐘睡覺。'},
  {t:'羽',  p:'柔軟讓你飛得更遠。', a:'對自己說一句溫柔的話。'},
  {t:'琴',  p:'別忘了調音。', a:'為明天設定 1 個可衡量的節奏。'},
  {t:'路標',p:'你在路上，也是路標。', a:'把今天的 1 個洞見寫下並分享。'},
  {t:'貝殼',p:'聽見海，也聽見自己。', a:'今天做一次內在聆聽。'},
  {t:'花',  p:'盛開不是義務，是回應。', a:'完成 1 件讓你愉悅的小事。'},
  {t:'鏡',  p:'你所見，皆是你。', a:'覺察一個投射並收回它。'},
  {t:'鎖',  p:'門在心裡。鑰匙也在。', a:'把「我不能」改寫成「我正在學」。'},
  {t:'雲',  p:'變化是常態。', a:'把焦點放在當下 60 秒。'},
  {t:'軌道',p:'你的習慣正在塑形。', a:'固定一個微小的日常。'},
  {t:'岸',  p:'記得靠岸。', a:'結束一天前做 2 分鐘回顧。'},
  {t:'黎明',p:'請把希望寫進時間。', a:'明早第一件事，做 1 件最重要的事。'},
  {t:'誓約',p:'你與自己有約。', a:'為自己立下一個善待自身的小約定。'},
  {t:'青藤',p:'向著光生長。', a:'今天多待在自然 3 分鐘。'},
  {t:'回聲',p:'你發出的終會回來。', a:'留下 1 句感謝。'},
  {t:'旅人',p:'你不是漂泊，你在朝聖。', a:'為旅程畫下一個小記號。'},
  {t:'歸所',p:'你永遠可以回家。', a:'把注意力帶回心口 10 秒。'}
];

/* ===================== YL 複方（60+，含中文） ===================== */
const YL_BLENDS = [
{name:"Peace & Calming", zh:"舒靜", d:"安撫情緒，帶來深層寧眠與內在平靜。"},
{name:"Harmony", zh:"和諧（樂融）", d:"平衡身心能量，促進內在與關係的協調連結。"},
{name:"Joy", zh:"喜悅", d:"喚醒內心喜悅與愛的頻率，帶來幸福感。"},
{name:"Valor", zh:"勇氣", d:"支撐內在力量，幫助你跨越恐懼與挑戰。"},
{name:"Abundance", zh:"豐盛", d:"提升顯化能量，吸引繁盛與豐裕。"},
{name:"Forgiveness", zh:"寬恕", d:"釋放過去結，帶來心靈的自由與療癒。"},
{name:"Stress Away", zh:"樂自在", d:"溫柔舒緩壓力，讓身心回歸自在。"},
{name:"Dream Catcher", zh:"捕夢網", d:"開啟靈感與想像，支持夢境與直覺顯化。"},
{name:"Sacred Mountain", zh:"聖山", d:"穩固如山的內在力量，帶來神聖守護感。"},
{name:"White Angelica", zh:"白使者", d:"純淨守護能量，讓你感受到被愛與保護。"},
{name:"Release", zh:"釋放", d:"溫柔釋放積累的情緒與壓力。"},
{name:"En-R-Gee", zh:"覺醒能量", d:"喚醒身體動力與精神活力。"},
{name:"Acceptance", zh:"接受", d:"擁抱當下，與現實和平相處。"},
{name:"Clarity", zh:"澄晰", d:"清晰心智，協助釐清方向與意圖。"},
{name:"R.C.", zh:"樂C", d:"促進呼吸與能量流動，帶來清新感。"},
{name:"Thieves", zh:"盜賊", d:"強化防護場域，支持清新與穩定。"},
{name:"Transformation", zh:"轉化", d:"支持深層蛻變與調頻。"},
{name:"Motivation", zh:"動力", d:"喚醒行動力與信心，讓能量前進。"},
{name:"Envision", zh:"願景", d:"協助看見心中藍圖，支持顯化。"},
{name:"Aroma Siez", zh:"舒活", d:"舒緩緊繃與壓力。"},
{name:"AromaEase", zh:"舒緩", d:"放鬆釋壓，回到自在呼吸。"},
{name:"Australian Kuranya", zh:"澳洲彩虹", d:"多元植物合奏的淨化與更新。"},
{name:"Brain Power", zh:"腦力（專注）", d:"提升專注與記憶，靈感湧現。"},
{name:"Build Your Dream", zh:"築夢", d:"支持夢想顯化與實踐。"},
{name:"Celebration", zh:"慶典", d:"帶來喜悅與榮耀的氛圍。"},
{name:"Citrus Fresh", zh:"優橘", d:"清新活力，提振心情。"},
{name:"EndoFlex", zh:"柔衡", d:"支持能量流動與內在平衡。"},
{name:"Energy", zh:"能量", d:"振奮精神，提升體力與行動力。"},
{name:"Evergreen Essence", zh:"常青精華", d:"喚起森林清新與穩定。"},
{name:"Exodus II", zh:"出埃及（埃及黃金）", d:"連結古老智慧與保護。"},
{name:"Gathering", zh:"聚合", d:"專注與靈性連結，召喚使命。"},
{name:"Gentle Baby", zh:"溫柔寶貝", d:"柔和滋養，適合親子與敏感時刻。"},
{name:"Gratitude", zh:"感恩", d:"提升正向能量與幸福感。"},
{name:"Grounding", zh:"穩定", d:"紮根當下，讓心安定。"},
{name:"Hope", zh:"希望", d:"注入希望與光明，重拾信念。"},
{name:"Humility", zh:"謙卑", d:"柔化自我，連結更高智慧。"},
{name:"Inner Child", zh:"內在小孩", d:"喚醒純真與自我接納。"},
{name:"Inspiration", zh:"靈感", d:"支持直覺與創造性流動。"},
{name:"Into the Future", zh:"未來展望", d:"放下過去，踏向新頁。"},
{name:"Live with Passion", zh:"熱情生活", d:"激發熱情與生命力。"},
{name:"Magnify Your Purpose", zh:"放大目標", d:"聚焦使命，放大實現力量。"},
{name:"Melrose", zh:"駐容", d:"更新能量，支持潔淨。"},
{name:"M-Grain", zh:"頭頸舒緩", d:"舒緩緊繃與壓力。"},
{name:"PanAway", zh:"舒敏", d:"舒緩與修復，恢復平衡。"},
{name:"Paraway", zh:"排淨", d:"支持清理與循環。"},
{name:"Present Time", zh:"當下", d:"回到此時此刻，增強臨在感。"},
{name:"Purification", zh:"淨化", d:"清除雜質與悶濁，恢復清新。"},
{name:"Raven", zh:"樂抒", d:"敞開胸臆，呼吸與心靈釋放。"},
{name:"RutaVaLa", zh:"舒眠", d:"放鬆身心，支持睡眠品質。"},
{name:"SARA", zh:"愛自己", d:"情感支持，修復過往創傷。"},
{name:"Sensation", zh:"感官", d:"喚醒感官與親密連結。"},
{name:"3 Wise Men", zh:"三位智者", d:"啟發智慧與內在覺醒。"},
{name:"Trauma Life", zh:"創傷釋放", d:"釋放深層創痛，心靈修復。"},
{name:"Tranquil", zh:"寧靜", d:"帶來安定與放鬆。"},
{name:"Aroma Life", zh:"生命之香", d:"支持循環與活力。"},
{name:"AromaLux", zh:"能量擴香", d:"清新振奮，提升空間感。"},
{name:"Believe", zh:"信念", d:"強化信心與信任生命。"},
{name:"Bliss", zh:"福樂", d:"輕快與幸福的氛圍。"},
{name:"Highest Potential", zh:"極致潛能", d:"喚醒天賦，攀向高峰。"},
{name:"Forgive Me", zh:"自我寬恕", d:"對自己更溫柔。"},
{name:"Gentle Night", zh:"柔夜", d:"放鬆入眠的溫柔陪伴。"},
{name:"Harmony II", zh:"和諧 II", d:"再平衡，再一致。"},
{name:"Joyful Moments", zh:"喜悅時刻", d:"提升幸福波段。"},
{name:"Light & Love", zh:"光與愛", d:"溫暖擁抱與慈愛流動。"},
{name:"Oola Balance", zh:"烏拉平衡", d:"全方位平衡與整合。"},
{name:"Oola Finance", zh:"烏拉財富", d:"建立富足與秩序。"},
{name:"Oola Family", zh:"烏拉家庭", d:"連結與支持的能量。"},
{name:"Oola Faith", zh:"烏拉信念", d:"信任與對齊。"},
{name:"Oola Fitness", zh:"烏拉活力", d:"身心能量的動能。"},
{name:"Oola Fun", zh:"烏拉樂趣", d:"輕鬆玩心，愉悅前行。"},
{name:"Raindrop", zh:"能量雨", d:"淨化與調頻的序曲。"},
{name:"Valor II", zh:"勇氣 II", d:"穩定支撐版本。"},
{name:"White Light", zh:"白光", d:"清淨守護。"},
{name:"Awaken", zh:"甦醒", d:"喚醒靈魂，對齊願景。"}
]; // ~60+

/* ===================== 今日精油：依最低兩階推薦（2 款） ===================== */
async function ensureYL(){ return true; }
function oilBlock(o){ return `<div class="card"><b>${o.name}</b>（${o.zh}）<br><span class="small">${o.d}</span></div>`; }
async function pickTodayOils(vals){
  const box=document.getElementById('oilBox');
  if(!vals.length){ box.textContent='請先完成量表並生成雷達圖。'; return; }
  await ensureYL();
  const list = vals.map((v,i)=>({i,v})).sort((a,b)=>a.v-b.v);
  const idxs = [list[0].i, list[1].i];
  const picks = [];
  idxs.forEach(i=>{ picks.push(YL_BLENDS[Math.floor(Math.random()*YL_BLENDS.length)]); });
  box.innerHTML = picks.map(oilBlock).join('');
}

/* ===================== 旅程進度（每日一次） ===================== */
const JOURNEYS=[{key:'j7',days:7},{key:'j21',days:21},{key:'j30',days:30}];
function todayKey(){ const d=new Date(); return d.getFullYear()+'-'+(d.getMonth()+1)+'-'+d.getDate(); }
function readJ(k){ try{return JSON.parse(localStorage.getItem(k)||'{"d":0,"last":""}');}catch(e){return {d:0,last:''};} }
function writeJ(k,o){ localStorage.setItem(k,JSON.stringify(o)); }
function markDay(which){
  const j=JOURNEYS[which]; const o=readJ(j.key); const tk=todayKey();
  if(o.last===tk){ alert('今天已打卡，明天再來 ✨'); return false; }
  o.d=Math.min(o.d+1,j.days); o.last=tk; writeJ(j.key,o); renderJourney(); maybeUnlock(which,o.d===j.days); return true;
}
function pct(x,max){ return Math.round(100*x/max); }
function renderJourney(){
  [{p:'p7',t:'t7',l:'lock7',btn:'btn7',j:JOURNEYS[0]},
   {p:'p21',t:'t21',l:'lock21',btn:'btn21',j:JOURNEYS[1]},
   {p:'p30',t:'t30',l:'lock30',btn:'btn30',j:JOURNEYS[2]}].forEach((u,i)=>{
    const o=readJ(u.j.key);
    document.getElementById(u.p).style.width=pct(o.d,u.j.days)+'%';
    document.getElementById(u.t).textContent=`${o.d} / ${u.j.days} 天`+(o.last?`（${o.last}）`:'');
    const lock=document.getElementById(u.l);
    lock.classList.toggle('unlock', o.d>=u.j.days);
    const btn=document.getElementById(u.btn);
    btn.onclick=()=>markDay(i);
  });
}
function maybeUnlock(which,done){
  if(!done) return;
  const card = HIDDEN_CARDS[(readJ('unlock_idx_'+which).d||0)%HIDDEN_CARDS.length];
  localStorage.setItem('unlock_idx_'+which, JSON.stringify({d:(readJ('unlock_idx_'+which).d||0)+1}));
  setTimeout(()=>{
    alert(`🔴 隱藏靈魂卡｜${card.t}\n\n${card.p}\n\n行動：${card.a}`);
  },50);
}

/* ===================== 啟動與事件 ===================== */
function drawOracle(allowRefresh=true){
  const box=document.getElementById('oracleBox'); const key='oracle_'+todayKey();
  if(!allowRefresh && localStorage.getItem(key)){ box.innerHTML=localStorage.getItem(key); return; }
  const pick = ORACLE[Math.floor(Math.random()*ORACLE.length)];
  const html = `<b>「${pick.t}」</b>\n${pick.p}\n\n<span class="ok">行動：</span>${pick.a}`;
  box.innerHTML = html; localStorage.setItem(key, html);
}
document.getElementById('drawOracle').addEventListener('click',()=>drawOracle(false));
document.getElementById('genRadar').addEventListener('click',()=>{
  const raw=collectVals(); saveScores(raw);
  const means=toPhaseMeans(raw); drawRadar(means); renderInfoCards(raw); pickTodayOils(raw);
});
document.getElementById('swapOil').addEventListener('click',()=>pickTodayOils(loadLastScores()));

(function boot(){
  renderJourney(); drawOracle(false);
  const prev = loadLastScores(); if(prev.length){ drawRadar(toPhaseMeans(prev)); renderInfoCards(prev); }
})();
</script>
</body></html>