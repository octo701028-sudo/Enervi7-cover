
<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Enervi7 v7.0 Core</title>
<link rel="manifest" href="manifest.json"/>
<meta name="theme-color" content="#6c36c6"/>
<style>
:root{
  --bg:#0f0b26; --panel:#161235; --panel2:#1b1542; --ink:#f4f0ff; --muted:#b7aee0; --acc:#7d4dff;
  --ok:#22c55e; --mid:#f59e0b; --bad:#ef4444;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans TC",Roboto,Helvetica,Arial,sans-serif}
header{padding:16px 20px;background:linear-gradient(180deg,#6c36c6,#4d2ea8);position:sticky;top:0;z-index:10}
h1{margin:0;font-size:22px}
.small{opacity:.85;font-size:12px}
.container{max-width:880px;margin:0 auto;padding:16px}
.card{background:var(--panel);border-radius:14px;padding:14px 16px;margin:12px 0;box-shadow:0 6px 24px rgba(0,0,0,.25)}
section h2{font-size:18px;margin:0 0 10px}
.btn{background:var(--acc);color:#fff;border:0;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
.row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
.range{padding:12px;background:var(--panel2);border-radius:12px;margin:10px 0}
label{display:block;margin-bottom:6px}
input[type=range]{width:100%}
.badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:12px;margin-left:6px;border:1px solid rgba(255,255,255,.18)}
.badge.ok{color:var(--ok);border-color:rgba(34,197,94,.35)}
.badge.mid{color:var(--mid);border-color:rgba(245,158,11,.35)}
.badge.bad{color:var(--bad);border-color:rgba(239,68,68,.35)}
#radar svg{width:100%;max-height:360px;background:#120e2d;border-radius:12px}
.detail{background:#120e2d;border-radius:12px;padding:10px 12px;margin-top:10px;border:1px solid rgba(255,255,255,.06)}
.tag{display:inline-block;border:1px solid #3b2e85;color:#cfc5ff;padding:2px 6px;border-radius:8px;margin:2px;font-size:12px}
hr.sep{border:none;border-top:1px dashed rgba(255,255,255,.14);margin:12px 0}
</style>
</head>
<body>
<header>
  <h1>Enervi7 v7.0 Core</h1>
  <div class="small">æœ¬ç‰ˆå°ç‰ˆï¼š<b>14 é¡Œé‡è¡¨ + SVG é›·é” + ä¸ƒéšè³‡è¨Šå¡</b>ï¼ˆé›¢ç·šå¯ç”¨ï¼Œä¸ä¾è³´å¤–éƒ¨ CDNï¼‰</div>
</header>

<div class="container">

  <section class="card" id="qs">
    <h2>ğŸ§­ 14 é¡Œé‡è¡¨ï¼ˆ0â€“10ï¼‰</h2>
    <div class="small">0 = å®Œå…¨ä¸ç¬¦åˆï¼å¹¾ä¹æ²’æœ‰ã€€ï½œã€€10 = éå¸¸ç¬¦åˆï¼å¹¾ä¹ç¸½æ˜¯</div>
    <div id="qwrap"></div>
    <div class="row">
      <button class="btn" id="gen">ç”Ÿæˆèƒ½é‡é›·é”</button>
      <button class="btn" id="reset" style="background:#43318f">é‡ç½®åˆ†æ•¸</button>
    </div>
  </section>

  <section class="card" id="radarCard" style="display:none">
    <h2>âš¡ èƒ½é‡é›·é”åœ–</h2>
    <div id="radar"></div>
    <div id="summary" class="small" style="margin-top:8px;opacity:.9"></div>
  </section>

  <section class="card" id="cards" style="display:none">
    <h2>ğŸŒˆ ä¸ƒéšè³‡è¨Šå¡ï¼ˆè‡ªå‹•å±•é–‹æœ€ä½å…©éšï¼‰</h2>
    <div id="cardsWrap"></div>
  </section>

</div>

<script>
// ---- åŸºç¤è³‡æ–™ ----
const STAGES=[
 {id:'S1', name:'ç™½ï½œèƒ½é‡è¦ºçŸ¥'},
 {id:'S2', name:'è—ï½œç©©å®šèˆ‡æ·¨åŒ–'},
 {id:'S3', name:'æ©™ï½œèƒ½é‡æµå‹•'},
 {id:'S4', name:'é»ƒï½œå…§åœ¨åŠ›é‡'},
 {id:'S5', name:'ç¶ ï½œå…±æŒ¯èˆ‡é€£çµ'},
 {id:'S6', name:'é›è—ï½œæ„è­˜æ“´å±•'},
 {id:'S7', name:'ç´«ï½œéˆé­‚æ•´åˆ'},
];
const QUESTIONS=[
  {stage:'S1', text:'æˆ‘èƒ½æ¸…æ¥šè¦ºå¯Ÿè‡ªå·±æ­¤åˆ»çš„èº«å¿ƒç‹€æ…‹ã€‚'},
  {stage:'S1', text:'æˆ‘èƒ½åœ¨æ··äº‚æ™‚ï¼Œè¿…é€ŸæŠŠæ³¨æ„åŠ›å¸¶å›ç•¶ä¸‹ã€‚'},
  {stage:'S2', text:'é¢å°å£“åŠ›æˆ–è¡çªæ™‚ï¼Œæˆ‘èƒ½ä¿æŒå†·éœä¸å¤±è¡¡ã€‚'},
  {stage:'S2', text:'æˆ‘èƒ½æœ‰æ•ˆåœ°é‡‹æ”¾ç´¯ç©çš„è² é¢æƒ…ç·’èˆ‡é›œå¿µã€‚'},
  {stage:'S3', text:'æˆ‘å¸¸æ„Ÿè¦ºéˆæ„Ÿï¼æƒ…æ„Ÿåœ¨é«”å…§è‡ªç„¶æµå‹•ã€‚'},
  {stage:'S3', text:'æˆ‘èƒ½é †å‹¢èª¿æ•´æ­¥èª¿ï¼Œä¸åƒµç¡¬æˆ–å¡ä½ã€‚'},
  {stage:'S4', text:'åšæ±ºå®šæ™‚ï¼Œæˆ‘èƒ½å …å®šåœ°é¸æ“‡å°è‡ªå·±çœŸçš„å¥½çš„äº‹ã€‚'},
  {stage:'S4', text:'é‡åˆ°æŒ‘æˆ°ï¼Œæˆ‘ä»èƒ½ç›¸ä¿¡è‡ªå·±ä¸¦å¾€å‰ä¸€æ­¥ã€‚'},
  {stage:'S5', text:'æˆ‘èƒ½çœŸèª è¡¨é”ï¼Œä¹Ÿæ¨‚æ–¼å‚¾è½ä»–äººã€‚'},
  {stage:'S5', text:'æˆ‘èƒ½æ„Ÿåˆ°è‡ªå·±èˆ‡ä»–äººã€èˆ‡ä¸–ç•Œæ˜¯é€£çµçš„ã€‚'},
  {stage:'S6', text:'æˆ‘ä¿¡ä»»ç›´è¦ºï¼Œä¸”èƒ½å¾ä¸­ç²å¾—æœ‰ç”¨çš„æŒ‡å¼•ã€‚'},
  {stage:'S6', text:'æˆ‘èƒ½å¾æ—¥å¸¸äº‹ä»¶çœ‹è¦‹æ›´æ·±çš„æ´è¦‹èˆ‡æ„ç¾©ã€‚'},
  {stage:'S7', text:'æˆ‘èƒ½æŠŠéå»çš„ç¶“é©—æ•´åˆæˆåŠ›é‡ï¼Œè€Œä¸æ˜¯æ·é–ã€‚'},
  {stage:'S7', text:'æˆ‘å¸¸æ„Ÿåˆ°è‡ªå·±å®Œæ•´ã€å°ç”Ÿå‘½æ–¹å‘è¸å¯¦å®‰å¿ƒã€‚'},
];
const CARD_META={
  S1:{keywords:['è¦ºçŸ¥ç•¶ä¸‹','è¾¨è­˜æƒ…ç·’','çœ‹è¦‹æ¨¡å¼','èª å¯¦é¢å°'],
      actions:['å¯«ä¸‰å¥ã€Œæ­¤åˆ»æˆ‘çœŸå¯¦çš„æ„Ÿå—æ˜¯â€¦ã€','3 åˆ†é˜è…¹å¼å‘¼å¸ï¼ˆ4-4-6ï¼‰ä¸¦è¨˜éŒ„èº«é«”æ„Ÿå—','åˆ—å‡º 1 å€‹åè¦†å‡ºç¾çš„å¿µé ­ï¼Œæ¨™è¨˜ï¼šæ˜¯äº‹å¯¦é‚„æ˜¯è§£è®€ï¼Ÿ']},
  S2:{keywords:['é¬†ç¶è² è·','æƒ…ç·’ä»£è¬','æ”¾ä¸‹åŸ·è‘—','å®Œæˆå›æ”¶'],
      actions:['åšä¸€æ¬¡ã€Œå¯«äº†å°±æ’•/ç‡’ã€é‡‹æ”¾æ›¸å¯«ï¼ˆ2â€“3 æ®µï¼‰','èº«é«”æƒæï¼Œå°ç·Šç¹ƒéƒ¨ä½åš 60 ç§’æ”¾é¬†','å°‡ä¸€ä»¶æ‹–å»¶å°äº‹ä»Šå¤©å®Œæˆä¸¦æ‰“å‹¾']},
  S3:{keywords:['å…è¨±ç™¼ç”Ÿ','å°é½Šæ„åœ–','è³‡æºæ„Ÿ','å®‰å…¨æ„Ÿ'],
      actions:['ç”¨ã€Œæˆ‘å…è¨±â€¦ã€é€ å¥ 3 å¥ï¼ˆå°æ‡‰ä»Šæ—¥ç„¦é»ï¼‰','å›é¡§ 1 æ¬¡è¢«æ”¯æŒçš„è­‰æ“šï¼Œå¯«ä¸‹ç‚ºä½•å¯è¤‡è£½','ä»Šå¤©ä¸»å‹•è«‹æ±‚ä¸€æ¬¡å¹«åŠ©ï¼ˆå°ç¯„åœå³å¯ï¼‰']},
  S4:{keywords:['æœ€å°æ­¥é©Ÿ','å¯é©—è­‰','ç¯€å¥','åŸ·è¡ŒåŠ›'],
      actions:['æŠŠç›®æ¨™æ‹†æˆ 10 åˆ†é˜å¯å®Œæˆçš„ä¸€æ­¥ï¼Œç¾åœ¨å°±åš','è¨­å®šä»Šæ—¥ 3 ä»¶ MIT','å®Œæˆå¾Œã€Œå…¬é–‹å›å ±ã€çµ¦å¯ä¿¡ä»»å°è±¡']},
  S5:{keywords:['å°ˆæ³¨','å›é¥‹å¾ªç’°','éŸŒæ€§','è¿­ä»£'],
      actions:['æŠŠå¡é»â†’èª¿æ•´ 1 å€‹å¾®ç­–ç•¥ï¼ˆA/B å˜—è©¦ï¼‰','25 åˆ†é˜ç•ªèŒ„é˜å…¨ç¨‹å°ˆæ³¨','è¨˜éŒ„ 1 å€‹æœ‰æ•ˆå›é¥‹ï¼Œæ˜å¤©æ²¿ç”¨']},
  S6:{keywords:['é€£çµ','åƒ¹å€¼æ„Ÿ','è²¢ç»','æ“´æ•£'],
      actions:['åˆ†äº«ä¸€å€‹å°æˆæœæˆ–æ´è¦‹åˆ°ç¤¾ç¾¤ï¼æœ‹å‹','é‚€è«‹ 1 äººçµ¦å…·é«”å›é¥‹ï¼ˆ3 å¥å…·é«”æè¿°ï¼‰','ä¸»å‹•å»ºç«‹ä¸€å€‹åˆä½œå¯èƒ½ï¼ˆç™¼å‡ºä¸€å‰‡é‚€è«‹ï¼‰']},
  S7:{keywords:['ç¸½çµç¶“é©—','å›ºåŒ–ç¿’æ…£','çµæ§‹åŒ–','é•·æœŸåŒ–'],
      actions:['ç”¨ 5 å¥è©±æ‘˜è¦æœ¬é€± 3 ä»¶å­¸åˆ°ï¼‹1 æ”¹é€²','æŠŠæœ‰æ•ˆæ­¥é©Ÿå¯«æˆ Checklist ä¸¦å›ºå®šåˆ°è¡Œç¨‹','ç‚ºä¸‹å€‹é€±æœŸè¨­å®šä¸€å€‹å¯è¡¡é‡æŒ‡æ¨™ï¼ˆKPIï¼‰']},
};
const TRANSITIONS={
  'S1â†’S2':['æŠŠã€Œæˆ‘è§€å¯Ÿåˆ°â€¦ã€æ”¹å¯«æˆã€Œæˆ‘é¡˜æ„æ”¾ä¸‹â€¦ã€Ã—3','æƒ…ç·’æ›¸å¯«â†’èº«é«”æ”¾é¬†æ”¶å°¾ï¼ˆé ¸è‚©ï¼è…¹éƒ¨ï¼‰'],
  'S2â†’S3':['åˆ—å‡º 3 å€‹ç¾æœ‰è³‡æºï¼ˆäººï¼ç‰©ï¼æŠ€èƒ½ï¼‰','å¯« 1 æ®µï¼šè‹¥ä¸€åˆ‡å°æˆ‘æœ‰åˆ©ï¼Œä»Šå¤©æˆ‘å…è¨±ä»€éº¼ï¼Ÿ'],
  'S3â†’S4':['ç”¢å‡ºã€Œæœ€å°å¯è¡Œæ­¥é©Ÿã€ä¸¦åœ¨ 10 åˆ†é˜å…§å•Ÿå‹•','é ç´„ 1 å€‹ã€Œè¡Œå‹•æ™‚æ®µã€ï¼Œè¡Œå‰åªåšæº–å‚™æ¸…å–®'],
  'S4â†’S5':['æŠŠä»Šæ—¥è¡Œå‹•å›é¥‹è¨˜éŒ„ä¸¦åš 1 æ¬¡å¾®èª¿','å»ºç«‹ 25 åˆ†é˜å°ˆæ³¨å„€å¼ï¼ŒçµæŸå›é¡§ 2 åˆ†é˜'],
  'S5â†’S6':['å…¬é–‹åˆ†äº« 1 å€‹é€²å±•ï¼æ¡ˆä¾‹ï¼Œç´¢å–å…·é«”å›é¥‹','è¾¨è­˜æœ€è¢«å…±é³´çš„åƒ¹å€¼ï¼Œæ˜å¤©ä¸»æ‰“è©²å…ƒç´ '],
  'S6â†’S7':['æŠŠæœ‰æ•ˆåšæ³•å¯«æˆ SOPï¼Checklist','é¸ä¸€å€‹å¯æŒçºŒç¯€å¥ï¼ˆé€±ï¼æœˆï¼‰æ”¾é€²è¡Œäº‹æ›†'],
  'S7â†’S1':['æœ¬é€±å›é¡§ 3 å¥ï¼‹ä¸‹ä¸€è¼ªæ–°æ„åœ– 1 å¥','æŒ‘é¸ 1 å€‹æ¬²ç²¾é€²çš„æŒ‡æ¨™ï¼Œè¨­ç½®è§€æ¸¬æ–¹å¼'],
};

// ---- ç•«é¢çµ„è£ï¼š14 é¡Œ ----
const qwrap = document.getElementById('qwrap');
QUESTIONS.forEach((q, i)=>{
  const s = STAGES.find(x=>x.id===q.stage);
  const id = 'q'+(i+1);
  const div = document.createElement('div');
  div.className = 'range';
  div.innerHTML = `
    <label>${i+1}. <b>${s.name}</b>ï½œ${q.text}</label>
    <input type="range" min="0" max="10" step="1" value="5" id="${id}" oninput="document.getElementById('${id}-v').textContent=this.value">
    <div class="small">ç›®å‰ï¼š<span id="${id}-v">5</span> / 10</div>
  `;
  qwrap.appendChild(div);
});

// ---- è¨ˆç®—å¹³å‡ ----
function getAverages(){
  const m = {S1:[],S2:[],S3:[],S4:[],S5:[],S6:[],S7:[]};
  QUESTIONS.forEach((q, i)=>{
    const v = Number(document.getElementById('q'+(i+1)).value||0);
    m[q.stage].push(v);
  });
  const avg={}; Object.keys(m).forEach(k=> avg[k] = m[k].reduce((a,b)=>a+b,0)/m[k].length );
  return avg;
}

// ---- é›·é”åœ–ï¼ˆç´” SVGï¼‰ ----
function drawRadar(avg){
  const axes = ['S1','S2','S3','S4','S5','S6','S7'];
  const size=320, cx=size/2, cy=size/2, R=130;
  const toXY = (i, r)=>{
    const ang = -Math.PI/2 + i*2*Math.PI/axes.length;
    return [cx + r*Math.cos(ang), cy + r*Math.sin(ang)];
  };
  let svg = `<svg viewBox="0 0 ${size} ${size}" aria-label="èƒ½é‡é›·é”åœ–">`;
  // rings
  for(let g=1; g<=5; g++){
    const r=R*g/5;
    svg += `<circle cx="${cx}" cy="${cy}" r="${r}" fill="none" stroke="#2a215e" stroke-width="1"/>`;
  }
  // axes
  axes.forEach((_,i)=>{
    const [x,y]=toXY(i,R);
    svg += `<line x1="${cx}" y1="${cy}" x2="${x}" y2="${y}" stroke="#2a215e" stroke-width="1"/>`;
  });
  // polygon
  const pts = axes.map((k,i)=>{
    const v=avg[k]||0; const r=R*(v/10); const [x,y]=toXY(i,r); return `${x},${y}`;
  }).join(' ');
  svg += `<polygon points="${pts}" fill="rgba(125,77,255,.45)" stroke="#a78bfa" stroke-width="2"/>`;
  // labels
  axes.forEach((k,i)=>{
    const [x,y]=toXY(i, R+14);
    const label = STAGES.find(s=>s.id===k).name;
    svg += `<text x="${x}" y="${y}" fill="#cfc5ff" font-size="10" text-anchor="middle">${label}</text>`;
  });
  svg += `</svg>`;
  document.getElementById('radar').innerHTML = svg;
}

// ---- è³‡è¨Šå¡ï¼ˆæœ€ä½å…©éšï¼‰ ----
function nextStageId(id){ const i=STAGES.findIndex(s=>s.id===id); return STAGES[(i+1)%STAGES.length].id; }
function badge(v){ return v>=7.5?'<span class="badge ok">å„ªå‹¢</span>': v>=5.5?'<span class="badge mid">è§€ç…§</span>':'<span class="badge bad">è£œå¼·</span>'; }
function renderCards(avg){
  const arr = Object.keys(avg).map(k=>({id:k,score:avg[k]})).sort((a,b)=>a.score-b.score).slice(0,2);
  const wrap = document.getElementById('cardsWrap'); wrap.innerHTML='';
  arr.forEach(it=>{
    const meta = CARD_META[it.id]; const next = nextStageId(it.id);
    const trans = TRANSITIONS[`${it.id}â†’${next}`] || [];
    const box = document.createElement('div');
    box.className='detail';
    box.innerHTML = `
      <div><b>${STAGES.find(s=>s.id===it.id).name}</b>ï½œå¹³å‡ <b>${it.score.toFixed(1)}</b> åˆ† ${badge(it.score)}</div>
      <div class="small" style="margin:6px 0">é—œéµå­—ï¼š${meta.keywords.map(k=>`<span class="tag">${k}</span>`).join('')}</div>
      <hr class="sep"/>
      <div><b>è¡Œå‹•å»ºè­°</b><br>${meta.actions.map(a=>`â€¢ ${a}`).join('<br>')}</div>
      <hr class="sep"/>
      <div><b>ç“¶é ¸è½‰æ›ï¼ˆ${it.id.replace('S','S')}â†’${next}ï¼‰</b><br>${trans.map(t=>`â€¢ ${t}`).join('<br>')}</div>
    `;
    wrap.appendChild(box);
  });
}

// ---- äº‹ä»¶ ----
document.getElementById('gen').addEventListener('click', ()=>{
  const avg = getAverages();
  drawRadar(avg);
  document.getElementById('radarCard').style.display='block';
  document.getElementById('cards').style.display='block';
  const txt = STAGES.map(s=>`${s.name}ï¼š${avg[s.id].toFixed(1)}`).join(' ï½œ ');
  document.getElementById('summary').textContent = txt;
  renderCards(avg);
  // persist last answers
  const ans = Array.from({length:14}, (_,i)=> Number(document.getElementById('q'+(i+1)).value||0) );
  localStorage.setItem('e7_v70_scores', JSON.stringify(ans));
});
document.getElementById('reset').addEventListener('click', ()=>{
  for(let i=1;i<=14;i++){ const el=document.getElementById('q'+i); if(el){ el.value=5; document.getElementById('q'+i+'-v').textContent='5'; } }
  localStorage.removeItem('e7_v70_scores');
});

// æ¢å¾©ä¸Šæ¬¡åˆ†æ•¸ï¼ˆè‹¥å­˜åœ¨ï¼‰
(function restore(){
  try{
    const ans = JSON.parse(localStorage.getItem('e7_v70_scores')||'null');
    if(Array.isArray(ans) && ans.length===14){
      ans.forEach((v,i)=>{ const el=document.getElementById('q'+(i+1)); if(el){ el.value=v; document.getElementById('q'+(i+1)+'-v').textContent=v; } });
    }
  }catch(e){}
})();

// PWA
if('serviceWorker' in navigator){ navigator.serviceWorker.register('./sw.js'); }
</script>
</body>
</html>
